{"version":3,"sources":["node_modules/deep-is/index.js","src/utilities/uuid.js","node_modules/sbd/lib/sanitize-html-browser.js","node_modules/sbd/lib/stringHelper.js","node_modules/sbd/lib/Match.js","node_modules/sbd/lib/tokenizer.js","src/utilities/inflate.js","src/utilities/message.js","src/utilities/index.js","src/editor/empty.js","src/editor/htmlToStringArray.js","src/editor/textToArray.js","src/editor/terminate.js","src/editor/getCandidateString.js","src/editor/arrayToHtml.js","src/editor/index.js","src/divider/index.js","src/editor/collectionToHtml.js","src/article/index.js","src/index.js","../../../.nvm/versions/node/v8.10.0/lib/node_modules/parcel-bundler/src/builtins/bundle-url.js","../../../.nvm/versions/node/v8.10.0/lib/node_modules/parcel-bundler/src/builtins/css-loader.js"],"names":["serial","uuid","alpha","Date","valueOf","toString","Math","floor","random","slice","inflate","text","array","SBD","sentences","join","messages","confirmDelete","key","timer","count","delay","time","replace","storage","sufix","ns","filter","val","read","data","localStorage","JSON","parse","write","obj","clearTimeout","setTimeout","console","log","stringify","deepEqual","message","empty","s","undefined","settings","require","htmlToStringArray","children","options","prefixToken","className","map","el","innerText","classList","is_comment","contains","prefix","trim","textToArray","split","re_punctuation","terminate","autoTerminate","is_closed","test","re_comments","getCandidateString","value","is_array","constructor","Array","line","length","comment","RegExp","arrayToHtml","editor","config","defaultConfig","cache","candidate","versions","triggerDictionary","cleanup","cleanupBlanks","shiftshift","toggleComment","clearVersions","innerHTML","load","initialize","html","Object","assign","focus","notifyChanges","bool","document","getSelection","focusNode","parentNode","skip","nodeName","toggle","rows","forEach","row","n","remove","executeTriggers","e","keyTime","keyHistory","window","toLowerCase","trigger","bindEvents","ts","hist","onkeyup","doubleTap","resetDelay","diff","timeStamp","push","getVersionArray","onChange","string","nextCandidate","String","nextVersions","a","b","execute","sort","addOnChange","fn","callback","id","selector","querySelector","clear","A","B","vertical","dragging","u","state","width","minWidth","threshold","save","temp","resize","pageX","stopPropagation","preventDefault","cancelBubble","returnValue","innerWidth","Number","max","min","percent","add","style","left","onmousedown","ondblclick","onmouseup","onmousemove","collectionToHtml","classname","json","div","createElement","dataset","outerHTML","article","selected","sample","callbacks","click","dblclick","handleKeyDown","handleClick","target","handleDoubleClick","confirm","list","articles","keys","collection","now","current","opened","create","name","created","open","index","prompt","newobject","update","error","onclick","onkeydown","methods","RE","$focusOn","local","divider","reloadEditor","toggleParagraph","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","url","exports","bundle","updateLink","link","newLink","cloneNode","onload","href","insertBefore","nextSibling","cssTimeout","reloadCSS","links","querySelectorAll","i","module"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACtGA,IAAIA,MAAM,GAAG,CAAb;;AACA,IAAMC,IAAI,GAAG,SAAPA,IAAO,GAAiB;AAAA,MAAhBC,KAAgB,uEAAR,GAAQ;AAC5BF,EAAAA,MAAM;AACN,SACEE,KAAK,GACL,CACE,IAAIC,IAAJ,GAAWC,OAAX,GAAqBC,QAArB,CAA8B,EAA9B,IAAoC;AACpCC,EAAAA,IAAI,CAACC,KAAL,CAAW,OAAOD,IAAI,CAACE,MAAL,KAAgB,IAAlC,EAAwCH,QAAxC,CAAiD,EAAjD,CADA,GACuD;AACvD,GAAC,OAAQL,MAAM,KAAK,IAApB,EAA2BK,QAA3B,CAAoC,CAApC,CAFA,GAEyC;AACzC,IAJF,EAKEI,KALF,CAKQ,CAAC,EALT,CAFF;AASD,CAXD;;eAaeR;;;ACdf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACpQA;;;;AAEA,SAASS,OAAT,CAAiBC,IAAjB,EAAuB;AACrB;AACA,MAAMC,KAAK,GAAGC,aAAIC,SAAJ,CAAcH,IAAd,CAAd;;AACA,SAAOC,KAAK,CAACG,IAAN,CAAW,MAAX,CAAP;AACD;;eAEcL;;;;;;;;;ACRf,IAAMM,QAAQ,GAAG;AACfC,EAAAA,aAAa;AAD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","file":"src.a2b27638.map","sourceRoot":"..","sourcesContent":["var pSlice = Array.prototype.slice;\nvar Object_keys = typeof Object.keys === 'function'\n    ? Object.keys\n    : function (obj) {\n        var keys = [];\n        for (var key in obj) keys.push(key);\n        return keys;\n    }\n;\n\nvar deepEqual = module.exports = function (actual, expected) {\n  // enforce Object.is +0 !== -0\n  if (actual === 0 && expected === 0) {\n    return areZerosEqual(actual, expected);\n\n  // 7.1. All identical values are equivalent, as determined by ===.\n  } else if (actual === expected) {\n    return true;\n\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n\n  } else if (isNumberNaN(actual)) {\n    return isNumberNaN(expected);\n\n  // 7.3. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (typeof actual != 'object' && typeof expected != 'object') {\n    return actual == expected;\n\n  // 7.4. For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected);\n  }\n};\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isArguments(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n}\n\nfunction isNumberNaN(value) {\n  // NaN === NaN -> false\n  return typeof value == 'number' && value !== value;\n}\n\nfunction areZerosEqual(zeroA, zeroB) {\n  // (1 / +0|0) -> Infinity, but (1 / -0) -> -Infinity and (Infinity !== -Infinity)\n  return (1 / zeroA) === (1 / zeroB);\n}\n\nfunction objEquiv(a, b) {\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b))\n    return false;\n\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b);\n  }\n  try {\n    var ka = Object_keys(a),\n        kb = Object_keys(b),\n        key, i;\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key])) return false;\n  }\n  return true;\n}\n","let serial = 0;\nconst uuid = (alpha = \"a\") => {\n  serial++;\n  return (\n    alpha +\n    (\n      new Date().valueOf().toString(16) + // eg 127b795136 (11)\n      Math.floor(1000 + Math.random() * 1000).toString(13) + // eg aa7 (3)\n      (1000 + (serial++ % 1000)).toString(5) + // eg 13001 (5)\n      \"\"\n    ).slice(-15)\n  );\n};\n\nexport default uuid;\n","\r\nmodule.exports = function sanitizeHtml(text, opts) {\r\n  // Strip HTML from Text using browser HTML parser\r\n  if ((typeof text == 'string' || text instanceof String) && typeof document !== \"undefined\") {\r\n    var $div = document.createElement(\"DIV\");\r\n    $div.innerHTML = text;\r\n    text = ($div.textContent || '').trim();\r\n  }\r\n  //DOM Object\r\n  else if (typeof text === 'object' && text.textContent) {\r\n    text = (text.textContent || '').trim();\r\n  }\r\n\r\n  return text;\r\n};\r\n","\r\nexports.endsWithChar = function ends_with_char(word, c) {\r\n    if (c.length > 1) {\r\n        return c.indexOf(word.slice(-1)) > -1;\r\n    }\r\n\r\n    return word.slice(-1) === c;\r\n};\r\n\r\nexports.endsWith = function ends_with(word, end) {\r\n    return word.slice(word.length - end.length) === end;\r\n};","var abbreviations;\r\nvar englishAbbreviations = [\r\n    \"al\",\r\n    \"adj\",\r\n    \"assn\",\r\n    \"Ave\",\r\n    \"BSc\", \"MSc\",\r\n    \"Cell\",\r\n    \"Ch\",\r\n    \"Co\",\r\n    \"cc\",\r\n    \"Corp\",\r\n    \"Dem\",\r\n    \"Dept\",\r\n    \"ed\",\r\n    \"eg\",\r\n    \"Eq\",\r\n    \"Eqs\",\r\n    \"est\",\r\n    \"est\",\r\n    \"etc\",\r\n    \"Ex\",\r\n    \"ext\", // + number?\r\n    \"Fig\",\r\n    \"fig\",\r\n    \"Figs\",\r\n    \"figs\",\r\n    \"i.e\",\r\n    \"ie\",\r\n    \"Inc\",\r\n    \"inc\",\r\n    \"Jan\",\"Feb\",\"Mar\",\"Apr\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Sept\",\"Oct\",\"Nov\",\"Dec\",\r\n    \"jr\",\r\n    \"mi\",\r\n    \"Miss\", \"Mrs\", \"Mr\", \"Ms\",\r\n    \"Mol\",\r\n    \"mt\",\r\n    \"mts\",\r\n    \"no\",\r\n    \"Nos\",\r\n    \"PhD\", \"MD\", \"BA\", \"MA\", \"MM\",\r\n    \"pl\",\r\n    \"pop\",\r\n    \"pp\",\r\n    \"Prof\", \"Dr\",\r\n    \"pt\",\r\n    \"Ref\",\r\n    \"Refs\",\r\n    \"Rep\",\r\n    \"repr\",\r\n    \"rev\",\r\n    \"Sec\",\r\n    \"Secs\",\r\n    \"Sgt\", \"Col\", \"Gen\", \"Rep\", \"Sen\",'Gov', \"Lt\", \"Maj\", \"Capt\",\"St\",\r\n    \"Sr\", \"sr\", \"Jr\", \"jr\", \"Rev\",\r\n    \"Sun\",\"Mon\",\"Tu\",\"Tue\",\"Tues\",\"Wed\",\"Th\",\"Thu\",\"Thur\",\"Thurs\",\"Fri\",\"Sat\",\r\n    \"trans\",\r\n    \"Univ\",\r\n    \"Viz\",\r\n    \"Vol\",\r\n    \"vs\",\r\n    \"v\",\r\n];\r\n\r\nexports.setAbbreviations = function(abbr) {\r\n    if(abbr){\r\n        abbreviations = abbr;\r\n    } else {\r\n        abbreviations = englishAbbreviations;\r\n    }\r\n}\r\n\r\nvar isCapitalized = exports.isCapitalized = function(str) {\r\n    return /^[A-Z][a-z].*/.test(str) || isNumber(str);\r\n}\r\n\r\n// Start with opening quotes or capitalized letter\r\nexports.isSentenceStarter = function(str) {\r\n    return isCapitalized(str) || /``|\"|'/.test(str.substring(0,2));\r\n}\r\n\r\nexports.isCommonAbbreviation = function(str) {\r\n    return ~abbreviations.indexOf(str.replace(/\\W+/g, ''));\r\n}\r\n\r\n// This is going towards too much rule based\r\nexports.isTimeAbbreviation = function(word, next) {\r\n    if (word === \"a.m.\" || word === \"p.m.\") {\r\n        var tmp = next.replace(/\\W+/g, '').slice(-3).toLowerCase();\r\n\r\n        if (tmp === \"day\") {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nexports.isDottedAbbreviation = function(word) {\r\n    var matches = word.replace(/[\\(\\)\\[\\]\\{\\}]/g, '').match(/(.\\.)*/);\r\n    return matches && matches[0].length > 0;\r\n}\r\n\r\n// TODO look for next words, if multiple are capitalized,\r\n// then it's probably not a sentence ending\r\nexports.isCustomAbbreviation = function(str) {\r\n    if (str.length <= 3) {\r\n        return true;\r\n    }\r\n\r\n    return isCapitalized(str);\r\n}\r\n\r\n// Uses current word count in sentence and next few words to check if it is\r\n// more likely an abbreviation + name or new sentence.\r\nexports.isNameAbbreviation = function(wordCount, words) {\r\n    if (words.length > 0) {\r\n        if (wordCount < 5 && words[0].length < 6 && isCapitalized(words[0])) {\r\n            return true;\r\n        }\r\n\r\n        var capitalized = words.filter(function(str) {\r\n            return /[A-Z]/.test(str.charAt(0));\r\n        });\r\n\r\n        return capitalized.length >= 3;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nvar isNumber = exports.isNumber = function(str, dotPos) {\r\n    if (dotPos) {\r\n        str = str.slice(dotPos-1, dotPos+2);\r\n    }\r\n\r\n    return !isNaN(str);\r\n};\r\n\r\n// Phone number matching\r\n// http://stackoverflow.com/a/123666/951517\r\nexports.isPhoneNr = function(str) {\r\n    return str.match(/^(?:(?:\\+?1\\s*(?:[.-]\\s*)?)?(?:\\(\\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\\s*\\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\\s*(?:[.-]\\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\\s*(?:[.-]\\s*)?([0-9]{4})(?:\\s*(?:#|x\\.?|ext\\.?|extension)\\s*(\\d+))?$/);\r\n};\r\n\r\n// Match urls / emails\r\n// http://stackoverflow.com/a/3809435/951517\r\nexports.isURL = function(str) {\r\n    return str.match(/[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)/);\r\n};\r\n\r\n// Starting a new sentence if beginning with capital letter\r\n// Exception: The word is enclosed in brackets\r\nexports.isConcatenated = function(word) {\r\n    var i = 0;\r\n\r\n    if ((i = word.indexOf(\".\")) > -1 ||\r\n        (i = word.indexOf(\"!\")) > -1 ||\r\n        (i = word.indexOf(\"?\")) > -1)\r\n    {\r\n        var c = word.charAt(i + 1);\r\n\r\n        // Check if the next word starts with a letter\r\n        if (c.match(/[a-zA-Z].*/)) {\r\n            return [word.slice(0, i), word.slice(i+1)];\r\n        }\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\nexports.isBoundaryChar = function(word) {\r\n    return word === \".\" ||\r\n           word === \"!\" ||\r\n           word === \"?\";\r\n};\r\n","/*jshint node:true, laxcomma:true */\r\n\"use strict\";\r\n\r\nvar sanitizeHtml = require('sanitize-html');\r\n\r\nvar stringHelper = require('./stringHelper');\r\nvar Match  = require('./Match');\r\n\r\nvar newline_placeholder = \" @~@ \";\r\nvar newline_placeholder_t = newline_placeholder.trim();\r\n\r\n\r\nvar whiteSpaceCheck = new RegExp(\"\\\\S\", \"\");\r\nvar addNewLineBoundaries = new RegExp(\"\\\\n+|[-#=_+*]{4,}\", \"g\");\r\nvar splitIntoWords = new RegExp(\"\\\\S+|\\\\n\", \"g\");\r\n\r\n\r\n// Split the entry into sentences.\r\nexports.sentences = function(text, user_options) {\r\n    if (!text || typeof text !== \"string\" || !text.length) {\r\n        return [];\r\n    }\r\n\r\n    if (!whiteSpaceCheck.test(text)) {\r\n      // whitespace-only string has no sentences\r\n      return [];\r\n    }\r\n\r\n    var options = {\r\n        \"newline_boundaries\"  : false,\r\n        \"html_boundaries\"     : false,\r\n        \"html_boundaries_tags\": [\"p\",\"div\",\"ul\",\"ol\"],\r\n        \"sanitize\"            : false,\r\n        \"allowed_tags\"        : false,\r\n        \"preserve_whitespace\" : false,\r\n        \"abbreviations\"       : null\r\n    };\r\n\r\n    if (typeof user_options === \"boolean\") {\r\n        // Deprecated quick option\r\n        options.newline_boundaries = true;\r\n    }\r\n    else {\r\n        // Extend options\r\n        for (var k in user_options) {\r\n            options[k] = user_options[k];\r\n        }\r\n    }\r\n\r\n    Match.setAbbreviations(options.abbreviations);\r\n\r\n    if (options.newline_boundaries) {\r\n        text = text.replace(addNewLineBoundaries, newline_placeholder);\r\n    }\r\n\r\n    if (options.html_boundaries) {\r\n        var html_boundaries_regexp = \"(<br\\\\s*\\\\/?>|<\\\\/(\" + options.html_boundaries_tags.join(\"|\") + \")>)\";\r\n        var re = new RegExp(html_boundaries_regexp, \"g\");\r\n        text = text.replace(re, \"$1\" + newline_placeholder);\r\n    }\r\n\r\n    if (options.sanitize || options.allowed_tags) {\r\n        if (! options.allowed_tags) {\r\n            options.allowed_tags = [\"\"];\r\n        }\r\n\r\n        text = sanitizeHtml(text, { \"allowedTags\" : options.allowed_tags });\r\n    }\r\n\r\n\r\n    // Split the text into words\r\n    var words;\r\n    var tokens;\r\n\r\n    // Split the text into words\r\n    if (options.preserve_whitespace) {\r\n        // <br> tags are the odd man out, as whitespace is allowed inside the tag\r\n        tokens = text.split(/(<br\\s*\\/?>|\\S+|\\n+)/);\r\n\r\n        // every other token is a word\r\n        words = tokens.filter(function (token, ii) {\r\n          return ii % 2;\r\n        });\r\n    }\r\n    else {\r\n        // - see http://blog.tompawlak.org/split-string-into-tokens-javascript\r\n        words = text.trim().match(splitIntoWords);\r\n    }\r\n\r\n\r\n    var wordCount = 0;\r\n    var index = 0;\r\n    var temp  = [];\r\n    var sentences = [];\r\n    var current   = [];\r\n\r\n    // If given text is only whitespace (or nothing of \\S+)\r\n    if (!words || !words.length) {\r\n        return [];\r\n    }\r\n\r\n    for (var i=0, L=words.length; i < L; i++) {\r\n        wordCount++;\r\n\r\n        // Add the word to current sentence\r\n        current.push(words[i]);\r\n\r\n        // Sub-sentences, reset counter\r\n        if (~words[i].indexOf(',')) {\r\n            wordCount = 0;\r\n        }\r\n\r\n        if (Match.isBoundaryChar(words[i]) || stringHelper.endsWithChar(words[i], \"?!\") || words[i] === newline_placeholder_t) {\r\n            if ((options.newline_boundaries || options.html_boundaries) && words[i] === newline_placeholder_t) {\r\n                current.pop();\r\n            }\r\n\r\n            sentences.push(current);\r\n\r\n            wordCount = 0;\r\n            current   = [];\r\n\r\n            continue;\r\n        }\r\n\r\n\r\n        if (stringHelper.endsWithChar(words[i], \"\\\"\") || stringHelper.endsWithChar(words[i], \"”\")) {\r\n            words[i] = words[i].slice(0, -1);\r\n        }\r\n\r\n        // A dot might indicate the end sentences\r\n        // Exception: The next sentence starts with a word (non abbreviation)\r\n        //            that has a capital letter.\r\n        if (stringHelper.endsWithChar(words[i], '.')) {\r\n            // Check if there is a next word\r\n            // This probably needs to be improved with machine learning\r\n            if (i+1 < L) {\r\n                // Single character abbr.\r\n                if (words[i].length === 2 && isNaN(words[i].charAt(0))) {\r\n                    continue;\r\n                }\r\n\r\n                // Common abbr. that often do not end sentences\r\n                if (Match.isCommonAbbreviation(words[i])) {\r\n                    continue;\r\n                }\r\n\r\n                // Next word starts with capital word, but current sentence is\r\n                // quite short\r\n                if (Match.isSentenceStarter(words[i+1])) {\r\n                    if (Match.isTimeAbbreviation(words[i], words[i+1])) {\r\n                        continue;\r\n                    }\r\n\r\n                    // Dealing with names at the start of sentences\r\n                    if (Match.isNameAbbreviation(wordCount, words.slice(i, 6))) {\r\n                        continue;\r\n                    }\r\n\r\n                    if (Match.isNumber(words[i+1])) {\r\n                        if (Match.isCustomAbbreviation(words[i])) {\r\n                            continue;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // Skip ellipsis\r\n                    if (stringHelper.endsWith(words[i], \"..\")) {\r\n                        continue;\r\n                    }\r\n\r\n                    //// Skip abbreviations\r\n                    // Short words + dot or a dot after each letter\r\n                    if (Match.isDottedAbbreviation(words[i])) {\r\n                        continue;\r\n                    }\r\n\r\n                    if (Match.isNameAbbreviation(wordCount, words.slice(i, 5))) {\r\n                        continue;\r\n                    }\r\n                }\r\n            }\r\n\r\n            sentences.push(current);\r\n            current   = [];\r\n            wordCount = 0;\r\n\r\n            continue;\r\n        }\r\n\r\n        // Check if the word has a dot in it\r\n        if ((index = words[i].indexOf(\".\")) > -1) {\r\n            if (Match.isNumber(words[i], index)) {\r\n                continue;\r\n            }\r\n\r\n            // Custom dotted abbreviations (like K.L.M or I.C.T)\r\n            if (Match.isDottedAbbreviation(words[i])) {\r\n                continue;\r\n            }\r\n\r\n            // Skip urls / emails and the like\r\n            if (Match.isURL(words[i]) || Match.isPhoneNr(words[i])) {\r\n                continue;\r\n            }\r\n        }\r\n\r\n        if (temp = Match.isConcatenated(words[i])) {\r\n            current.pop();\r\n            current.push(temp[0]);\r\n            sentences.push(current);\r\n\r\n            current = [];\r\n            wordCount = 0;\r\n            current.push(temp[1]);\r\n        }\r\n    }\r\n\r\n    if (current.length) {\r\n        sentences.push(current);\r\n    }\r\n\r\n\r\n    // Clear \"empty\" sentences\r\n    sentences = sentences.filter(function(s) {\r\n        return s.length > 0;\r\n    });\r\n\r\n    var result = sentences.slice(1).reduce(function (out, sentence) {\r\n      var lastSentence = out[out.length - 1];\r\n      // Single words, could be \"enumeration lists\"\r\n      if (lastSentence.length === 1 && /^.{1,2}[.]$/.test(lastSentence[0])) {\r\n          // Check if there is a next sentence\r\n          // It should not be another list item\r\n          if (!/[.]/.test(sentence[0])) {\r\n              out.pop()\r\n              out.push(lastSentence.concat(sentence));\r\n              return out;\r\n          }\r\n      }\r\n      out.push(sentence);\r\n      return out;\r\n    }, [ sentences[0] ]);\r\n\r\n    // join tokens back together\r\n    return result.map(function (sentence, ii) {\r\n      if (options.preserve_whitespace && !options.newline_boundaries && !options.html_boundaries) {\r\n        // tokens looks like so: [leading-space token, non-space token, space\r\n        // token, non-space token, space token... ]. In other words, the first\r\n        // item is the leading space (or the empty string), and the rest of\r\n        // the tokens are [non-space, space] token pairs.\r\n        var tokenCount = sentence.length * 2;\r\n        if (ii === 0) {\r\n          tokenCount += 1;\r\n        }\r\n        return tokens.splice(0, tokenCount).join('');\r\n      }\r\n      return sentence.join(\" \");\r\n    });\r\n};\r\n","import SBD from \"sbd\";\n\nfunction inflate(text) {\n  // returns sentences broken into lines\n  const array = SBD.sentences(text);\n  return array.join(\"\\n\\n\");\n}\n\nexport default inflate;\n","const messages = {\r\n  confirmDelete: `\r\nYou are unlocking this paragraph. \r\n\r\nThis will delete the working versions and destill \r\nthe paragraph to the currently elected candidate.\r\n\r\n[CANCEL] to keep working versions\r\n[OK] to discard versions\r\n`\r\n};\r\n\r\nexport default function(key) {\r\n  return messages[key] || `WARNING:\\n\\nCan't find [${key}] message.`;\r\n}\r\n","import deepEqual from \"deep-is\";\nimport uuid from \"./uuid\";\nimport inflate from \"./inflate\";\nimport message from \"./message\";\n\nlet timer;\nlet count = 0;\nlet delay = 250;\n\nfunction time() {\n  return new Date().toString().replace(/.* (\\d+:\\d+:\\d+) .*/g, \"$1\");\n}\nfunction storage(sufix = null) {\n  const ns = [\"rewrite\", sufix].filter(val => val).join(\"-\");\n\n  return {\n    read: () => {\n      const data = localStorage[ns] || null;\n      return data && JSON.parse(data);\n    },\n\n    write: obj => {\n      clearTimeout(timer);\n      count = (count || 0) + 1;\n      timer = setTimeout(() => {\n        console.log(\"localstroage SAVE\", count, time(), obj);\n        localStorage[ns] = JSON.stringify(obj);\n        count = 0;\n      }, delay);\n    }\n  };\n}\n\nexport default {\n  uuid,\n  deepEqual,\n  inflate,\n  storage,\n  message,\n  time\n};\n","function empty(s) {\n  if (s === undefined) return;\n  return s;\n}\n\nexport default empty;\n","const settings = require(\"./config\");\n\nfunction htmlToStringArray(children, options = {}) {\n  const { prefixToken, className } = { ...settings, ...options };\n\n  return [...children].map(el => {\n    const { innerText, classList } = el;\n    const is_comment = classList.contains(className);\n    const prefix = is_comment ? prefixToken : \"\";\n\n    return `${prefix}${innerText.trim()}`;\n  });\n}\n\nexport default htmlToStringArray;\n","function textToArray(text = null) {\n  // returns simple text Array\n  // correcting for double line breaks\n  if (!text) return;\n\n  return text.replace(/\\n\\n/gm, \"\\n\").split(/\\n/g);\n}\n\nexport default textToArray;\n","const re_punctuation = /(\\.|\\:|\\!|\\?|\\\"|\\))$/g;\n\nfunction terminate(text, autoTerminate = false) {\n  // return a closed sentnece.\n  text = text && text.trim();\n\n  if (!text) return;\n\n  var is_closed = re_punctuation.test(text);\n  var sufix = autoTerminate && !is_closed ? \".\" : \"\";\n\n  return `${text}${sufix}`;\n}\n\nexport default terminate;\n","import terminate from \"./terminate\";\nimport textToArray from \"./textToArray\";\n\nconst re_comments = /^([\\/\\>\\?\\=\\!]\\s*?)/;\n\nfunction getCandidateString(value, autoTerminate = false) {\n  // recieve String or Array\n  // returns string\n  // parse the DOM elements to simple Array\n\n  const is_array = value && value.constructor === Array;\n  const array = is_array ? value : textToArray(value);\n  return [...array]\n    .map(line =>\n      re_comments.test(line) ? null : terminate(line, autoTerminate)\n    )\n    .filter(s => s && s.length)\n    .join(\" \")\n    .trim();\n}\n\nexport default getCandidateString;\n","const comment = new RegExp(\"^[>]s?\", \"g\");\n\nfunction arrayToHtml(array) {\n  // returns DOM string\n  // parse comment chars to className \"comment\"\n\n  return [...array]\n    .map(text => {\n      const className = comment.test(text) ? ` class=\"comment\"` : \"\";\n      const value = text ? text.replace(comment, \"\").trim() : \"<br />\";\n\n      return `<div${className}>${value}</div>`;\n    })\n    .join(\"\\n\")\n    .toString();\n}\n\nexport default arrayToHtml;\n","import defaultConfig from \"./config\";\nimport empty from \"./empty\";\nimport htmlToStringArray from \"./htmlToStringArray\";\nimport textToArray from \"./textToArray\";\nimport getCandidateString from \"./getCandidateString\";\nimport arrayToHtml from \"./arrayToHtml\";\n\nimport \"./editor.scss\";\n\n/*\n\n  const e = initialize($elm, {...options})\n\n  e.onChange((candidate, versions) = console.log(candidate, versions))\n  \n  e.trigger(\"shiftaltalt\", toggleCase);\n\n  const toggleCase = el => {\n    const text = el.innerText;\n    const upper = text.toUpperCase() === text;\n    const toggle = upper ? \"toLowerCase\" : \"toUpperCase\";\n    el.innerText = text[toggle]();\n  };\n\n*/\n\nlet editor;\nlet config = { ...defaultConfig };\n\nlet cache = {\n  candidate: null, // string\n  versions: [null] // versions\n};\n\n// const re_comment_prefix = new RegExp(\"^[>]s?\", \"g\");\nconst re_punctuation = /(\\.|\\:|\\!|\\?|\\\"|\\))$/g;\nconst re_comments = /^([\\/\\>\\?\\=\\!]\\s*?)/;\nconsole.log(re_punctuation);\n\nconst triggerDictionary = {\n  cleanup: cleanupBlanks,\n  shiftshift: toggleComment\n};\n\n// [\"Lorem ipsum 1\",\"Lorem ipsum 2\",\"> Lorem ipsum 4\",\"\",\"Lorem ipsum 3\"]\nfunction clearVersions() {\n  editor.innerHTML = \"\";\n  editor = null;\n  cache.candidate = null;\n  cache.versions = [null];\n  // issue onClose event\n}\n\nfunction load(value = null, options = {}) {\n  if (!value) return;\n  if (!editor) initialize();\n\n  const array = value.constructor === Array ? value : textToArray(value);\n  const html = arrayToHtml(array);\n\n  config = Object.assign({}, config, options);\n\n  editor.innerHTML = html;\n  editor.focus();\n  notifyChanges();\n\n  return html;\n}\n\nfunction toggleComment(bool) {\n  var line = document.getSelection().focusNode.parentNode;\n  var text = line.innerText;\n  var skip = !/div/i.test(line.nodeName) || !text || !text.trim();\n\n  if (skip) return;\n\n  line.classList.toggle(\"comment\");\n}\n\nfunction cleanupBlanks(rows) {\n  [...rows].forEach((row, n) => {\n    const text = (row.innerText && row.innerText.trim()) || null;\n    text ? row : row.classList.remove(\"comment\");\n  });\n}\n\nfunction executeTriggers(e, keyTime, keyHistory) {\n  const { parentNode } = window.getSelection().focusNode;\n  const children = parentNode.children;\n\n  keyHistory = keyHistory.join(\"\").toLowerCase();\n\n  const { cleanup } = triggerDictionary;\n  const trigger =\n    triggerDictionary[keyHistory] ||\n    triggerDictionary[`id${keyHistory}`] ||\n    empty;\n\n  cleanup(children);\n  trigger(parentNode);\n  notifyChanges();\n}\n\nfunction bindEvents() {\n  let ts = 0;\n  let hist = [];\n\n  editor.onkeyup = e => {\n    const { doubleTap, resetDelay } = config;\n    const diff = e.timeStamp - ts;\n    const delay = diff < doubleTap;\n    ts = e.timeStamp;\n\n    hist = diff > resetDelay ? [] : hist;\n\n    hist.push(e.key);\n    hist = hist.slice(-5);\n\n    setTimeout(() => executeTriggers(e, delay, hist), 0);\n  };\n}\n\nfunction getVersionArray() {\n  const options = { ...config };\n  return htmlToStringArray(editor.children, options);\n}\n\nfunction notifyChanges() {\n  // if the candidate is diffrent OR\n  // if the version array is different\n  // execute the change\n  const { children } = editor;\n  const { candidate, versions } = { ...cache };\n  const { onChange } = config;\n  const string = htmlToStringArray(children);\n\n  const nextCandidate = String(getCandidateString(string));\n  const nextVersions = [...getVersionArray()];\n\n  // cheap checks first ...\n  const a = candidate !== nextCandidate;\n\n  const b = a || versions.length !== nextVersions.length;\n\n  // most expensive check\n  const execute =\n    b || versions.sort().join(\"\") !== nextVersions.sort().join(\"\");\n\n  // change detected\n  if (execute) {\n    cache = {\n      candidate: nextCandidate,\n      versions: nextVersions\n    };\n    onChange(nextCandidate, nextVersions);\n  }\n}\n\nfunction addOnChange(fn) {\n  config = Object.assign({}, config, { onChange: fn });\n}\n\nfunction trigger(key, callback) {\n  const id = triggerDictionary[key] ? `id${key}` : key;\n  triggerDictionary[id] = callback;\n  console.log(\"added trigger [%s]\", id, key);\n}\n\nfunction initialize(selector = null, options) {\n  config.selector = config.selector || selector;\n  editor = document.querySelector(config.selector);\n\n  if (!editor) {\n    throw `module requires DOM element [${selector}]`;\n  }\n\n  if (options) {\n    config = Object.assign({}, config, options);\n  }\n\n  bindEvents();\n  return {\n    load,\n    trigger,\n    clear: clearVersions,\n    settings: () => config,\n    onChange: addOnChange,\n    candidate: getCandidateString,\n    versions: htmlToStringArray\n  };\n}\n\nexport default initialize;\n","import u from \"../utilities\";\r\n\r\nlet A;\r\nlet B;\r\nlet vertical;\r\nlet dragging = false;\r\nconst { read, write } = u.storage(\"resizer\");\r\n\r\nlet state = Object.assign(\r\n  {},\r\n  {\r\n    width: 50, // initial ratio (percentage)\r\n    minWidth: 8, // min pixel width\r\n    threshold: 20, // screen width percentage\r\n\r\n    // DOM fixtures\r\n    vertical: \"#vertical\",\r\n    document: \".document\",\r\n    sentences: \".sentences\"\r\n  },\r\n  read()\r\n);\r\n\r\nfunction save(obj = {}) {\r\n  const data = { ...state, ...obj };\r\n  write(data);\r\n  return obj;\r\n}\r\n\r\nfunction settings(key, value) {\r\n  if (!key) return;\r\n\r\n  // key, value pairs\r\n  const temp = {};\r\n  if (key.constructor !== Object && value !== undefined) {\r\n    temp[key] = value;\r\n    key = { ...temp };\r\n  }\r\n\r\n  state = { ...state, key };\r\n  return save(state);\r\n}\r\n\r\nfunction resize(e, value) {\r\n  if (!dragging && !value) return;\r\n\r\n  let { pageX } = e || {};\r\n\r\n  if (e) {\r\n    // prevent cursor selecting during drag\r\n    e.stopPropagation && e.stopPropagation();\r\n    e.preventDefault && e.preventDefault();\r\n    e.cancelBubble = true;\r\n    e.returnValue = false;\r\n  }\r\n\r\n  const { threshold, minWidth } = state;\r\n  const { innerWidth } = window;\r\n\r\n  pageX = pageX || ((value || 50) / 100) * innerWidth;\r\n  let width = value || Number((pageX / innerWidth) * 100);\r\n  width = Math.max(minWidth, width);\r\n  width = Math.min(100 - minWidth, width);\r\n\r\n  let percent = width;\r\n  A.classList.remove(\"hide-content\");\r\n  B.classList.remove(\"hide-content\");\r\n  vertical.classList.remove(\"hide-menu-left\");\r\n  vertical.classList.remove(\"hide-menu-right\");\r\n\r\n  if (width < threshold) {\r\n    // 15 (100-85) (innerWidth - minWidth) / innerWidth\r\n    percent = 100 * (minWidth / innerWidth);\r\n    A.classList.add(\"hide-content\");\r\n    vertical.classList.add(\"hide-menu-left\");\r\n  }\r\n  if (width > 100 - threshold) {\r\n    percent = 100 - 100 * ((minWidth * 1.5) / innerWidth);\r\n    B.classList.add(\"hide-content\");\r\n    vertical.classList.add(\"hide-menu-right\");\r\n  }\r\n\r\n  A.style.width = `${percent}%`;\r\n  B.style.width = `${100 - percent}%`;\r\n  vertical.style.left = `${percent}%`;\r\n\r\n  save({ width: Number(percent) });\r\n}\r\n\r\nfunction initialize(options = {}) {\r\n  vertical = document.querySelector(state.vertical);\r\n  A = document.querySelector(state.document);\r\n  B = document.querySelector(state.sentences);\r\n\r\n  vertical.onmousedown = () => (dragging = true);\r\n  vertical.ondblclick = e => resize(e, 50);\r\n\r\n  window.onmouseup = () => {\r\n    dragging = false;\r\n    console.log(\"WINDOW [%s]\", state.width);\r\n  };\r\n\r\n  window.onmousemove = resize;\r\n\r\n  save(options);\r\n  resize(null, state.width);\r\n\r\n  console.log(\"resizer initialized\");\r\n\r\n  return { resize, settings };\r\n}\r\n\r\nexport default initialize;\r\n","import uuid from \"../utilities/uuid\";\nimport getCandidateString from \"./getCandidateString\";\n\nfunction collectionToHtml(array) {\n  // returns HTML String\n  // Expected collection schema:\n  // [{text: String, versions: Object}, ...]\n\n  if (!array) return;\n\n  const html = array.map(row => {\n    const { text = \"\", versions = \"\" } = row;\n\n    const id = versions ? uuid() : \"\";\n    const classname = (versions && \"locked\") || \"\";\n    const value = text || (versions && getCandidateString(versions)) || \"\";\n    const json = versions ? JSON.stringify(versions) : \"\";\n\n    // create DOM element to ensure json is parsed correctly\n    // when we use it as data-version String\n    const div = document.createElement(\"div\");\n\n    // only render relavant attributes\n    id && (div.id = id);\n    classname && (div.className = classname);\n    versions && (div.dataset.versions = json);\n\n    div.innerHTML = value || \"<br/>\";\n\n    return div.outerHTML;\n  });\n\n  return html.join(\"\\n\");\n}\n\nexport default collectionToHtml;\n","import u from \"../utilities\";\nimport collectionToHtml from \"../editor/collectionToHtml\";\n\nlet article;\nlet selected;\nlet timer;\nlet delay = 1000;\n\nconst sample = require(\"./startup.json\");\nconst { read, write } = u.storage(\"article\");\n\nconst callbacks = {\n  click: () => {},\n  dblclick: () => {}\n};\n\nfunction callback(key, fn) {\n  callbacks[key.toLowerCase()] = fn;\n}\n\nfunction handleKeyDown(e) {\n  save();\n}\n\nfunction handleClick(e) {\n  // de-select any existing nodes\n  if (selected) {\n    selected.classList.remove(\"selected\");\n  }\n\n  // only load locked nodes\n  let { id, dataset } = e.target;\n  if (!id || !dataset.versions) return;\n\n  selected = document.querySelector(`#${id}`);\n  selected.classList.add(\"selected\");\n\n  const { versions } = dataset;\n  const json = versions && JSON.parse(versions);\n\n  callbacks.click(json, selected);\n}\n\nfunction handleDoubleClick(e) {\n  e.target.id = e.target.id || u.uuid();\n  let { id, innerText, dataset } = e.target;\n  const { versions } = dataset;\n  const text = u.inflate(innerText);\n  const value = (versions && JSON.parse(versions)) || text || \"\";\n\n  if (versions) {\n    // confirm delete\n    if (!window.confirm(u.message(\"confirmDelete\"))) return;\n\n    // next ... remove DOM reference\n    selected.id = \"\";\n    selected = null;\n\n    // next cleanup this\n    e.target.className = \"\";\n    e.target.id = \"\";\n    e.target.dataset.versions = \"\";\n\n    // update local storage\n    console.log(\"toggle off\", selected);\n    callbacks.dblclick(value, null);\n    return;\n  }\n\n  selected = document.querySelector(`#${id}`);\n  selected.className = \"locked selected\";\n  callbacks.dblclick(value, selected);\n}\n\nfunction list() {\n  const data = read();\n  const { articles } = data;\n  const keys = Object.keys(articles);\n  const list = keys.map((s, n) => n + \": \" + s).join(\"\\n\");\n  console.log(list);\n  return keys;\n}\n\nfunction save() {\n  timer && clearTimeout(timer);\n  timer = setTimeout(() => {\n    const collection = [...article.children].map(el => {\n      const { innerText = \"\", dataset } = el;\n      const versions = dataset.versions && JSON.parse(dataset.versions);\n      return { text: innerText.trim(), versions: versions };\n    });\n    const data = read();\n    const now = new Date().valueOf();\n    const { current } = data;\n    Object.assign(data.articles[current], { data: collection, opened: now });\n    write(data);\n  }, delay);\n}\n\nfunction create(key, data, name) {\n  const id = key || u.uuid();\n  const created = new Date().valueOf();\n  return { id, name, data, created };\n}\n\nfunction open() {\n  const keys = list();\n  const index = window.prompt(\"choose one:\");\n  load(keys[Number(index)]);\n}\n\nfunction load(key, name, collection) {\n  let id;\n  let data = read();\n  let current = null;\n  const ts = new Date().valueOf();\n\n  if (!data) {\n    const newobject = create(null, sample, \"Untitled\");\n    id = newobject.id;\n    data = { articles: {} };\n    data.articles[id] = { ...newobject };\n  }\n\n  // try to get the @key article\n  if (key && data.articles[key]) id = key;\n\n  // create a blank/new document\n  if (!id && (key || name || collection)) {\n    id = key || u.uuid();\n    name = name || \"New document\";\n    collection = collection || [{ text: name }];\n    data.articles[id] = create(id, collection, name);\n    console.log(\"NEW\", data.articles);\n  }\n\n  // try to use last document edited\n  if (!id && data.current && data.articles[data.current]) id = data.current;\n\n  // last resort open first article\n  if (!id) id = Object.keys(data.articles)[0];\n\n  current = data.articles[id];\n  current.opened = ts;\n  data.current = id;\n\n  //   const objectArray;\n  //   const innerHTML = collectionToHtml(local);\n  article.innerHTML = collectionToHtml(current.data);\n  write({ ...data });\n}\n\nfunction update(candidate, versions) {\n  // updates the currently selected node\n  if (!selected) {\n    console.error(\"cant update selected node\");\n    return;\n  }\n  selected.innerText = candidate;\n  selected.dataset.versions = JSON.stringify(versions);\n  save();\n}\n\nfunction initialize(selector = \"#document\") {\n  article = document.querySelector(selector);\n  article.ondblclick = handleDoubleClick;\n  article.onclick = handleClick;\n  article.onkeydown = handleKeyDown;\n\n  const methods = {\n    callback,\n    update,\n    load,\n    open,\n    save,\n    list\n  };\n\n  window.RE = {};\n  window.RE.article = methods;\n  return methods;\n}\n\nexport default initialize;\n","import u from \"./utilities\";\nimport editorInit from \"./editor\";\nimport divideInit from \"./divider\";\nimport articleInit from \"./article\";\n\nimport \"./styles.scss\";\n\n// load some text into the DOM\nlet $focusOn; // current node element\n\nconst local = u.storage().read();\nconst divider = divideInit();\nconst article = articleInit(\"#document\");\nconst editor = editorInit(\"#sentences\");\n\n// Passive events from Editor changes\neditor.onChange(article.update);\n\n// Initial DOM injection\narticle.callback(\"click\", reloadEditor);\narticle.callback(\"dblclick\", toggleParagraph);\narticle.load();\n\n// article.load(\"55555\", \"Kilroy!\", [{ text: \"Kilroy was here\" }]);\n// article.open();\n\nfunction reloadEditor(versions, el) {\n  editor.load(versions);\n  el && ($focusOn = el);\n}\n\nfunction toggleParagraph(versions, el) {\n  editor.load(versions);\n  $focusOn = el;\n}\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n"]}