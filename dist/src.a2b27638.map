{"version":3,"sources":["node_modules/deep-is/index.js","src/utilities/uuid.js","node_modules/sbd/lib/sanitize-html-browser.js","node_modules/sbd/lib/stringHelper.js","node_modules/sbd/lib/Match.js","node_modules/sbd/lib/tokenizer.js","src/utilities/inflate.js","src/utilities/message.js","src/utilities/wordcount.js","src/utilities/index.js","src/editor/empty.js","src/editor/htmlToStringArray.js","src/editor/textToArray.js","src/editor/terminate.js","src/editor/getCandidateString.js","src/editor/arrayToHtml.js","src/editor/index.js","src/divider/index.js","src/editor/collectionToHtml.js","src/article/index.js","src/index.js","../../../.nvm/versions/node/v8.10.0/lib/node_modules/parcel-bundler/src/builtins/bundle-url.js","../../../.nvm/versions/node/v8.10.0/lib/node_modules/parcel-bundler/src/builtins/css-loader.js"],"names":["serial","uuid","String","fromCharCode","toLowerCase","Date","valueOf","toString","Math","floor","random","slice","inflate","text","array","SBD","sentences","join","messages","confirmDelete","key","wordcount","value","replace","split","length","timer","count","delay","time","storage","sufix","ns","filter","val","read","data","localStorage","JSON","parse","write","obj","clearTimeout","setTimeout","console","log","stringify","deepEqual","message","empty","s","undefined","settings","require","htmlToStringArray","children","options","prefixToken","className","map","el","innerText","classList","is_comment","contains","prefix","trim","textToArray","re_punctuation","terminate","autoTerminate","is_closed","test","re_comments","getCandidateString","is_array","constructor","Array","line","comment","RegExp","arrayToHtml","editor","config","defaultConfig","cache","candidate","versions","triggerDictionary","cleanup","cleanupBlanks","shiftshift","toggleComment","controlt","clearVersions","innerHTML","setWordcount","row","words","dataset","updateWordCountDataset","showWordCount","load","initialize","html","Object","assign","focus","notifyChanges","bool","document","getSelection","focusNode","parentNode","skip","nodeName","toggle","rows","forEach","n","remove","executeTriggers","e","keyTime","keyHistory","window","wordCount","trigger","bindEvents","ts","hist","onkeyup","doubleTap","resetDelay","diff","timeStamp","push","getVersionArray","onChange","string","nextCandidate","nextVersions","a","b","execute","sort","addOnChange","fn","callback","id","selector","querySelector","clear","A","B","left","vertical","dragging","u","state","width","minWidth","threshold","save","temp","resize","pageX","stopPropagation","preventDefault","cancelBubble","returnValue","innerWidth","Number","max","min","percent","add","style","bindMenuEvents","onclick","target","RE","article","onmousedown","ondblclick","onmouseup","onmousemove","collectionToHtml","classname","json","div","createElement","outerHTML","selected","sample","callbacks","click","dblclick","handleKeyDown","handleClick","handleDoubleClick","confirm","list","articles","keys","name","htmlToCollection","collection","now","current","opened","create","created","open","index","prompt","newobject","update","error","importJSON","payload","object","exportJSON","local","filename","element","encodeURIComponent","setAttribute","display","body","appendChild","removeChild","onkeydown","methods","import","export","$focusOn","divider","reloadEditor","toggleParagraph","bundleURL","getBundleURLCached","getBundleURL","Error","err","matches","stack","match","getBaseURL","url","exports","bundle","updateLink","link","newLink","cloneNode","onload","href","insertBefore","nextSibling","cssTimeout","reloadCSS","links","querySelectorAll","i","module"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;ACtGA,IAAIA,MAAM,GAAG,CAAC,CAAd;;AACA,IAAMC,IAAI,GAAG,SAAPA,IAAO,GAAM;AACjBD,EAAAA,MAAM;AACN,SACEE,MAAM,CAACC,YAAP,CAAoB,KAAMH,MAAM,GAAG,EAAnC,EAAwCI,WAAxC,KACA,CACE,IAAIC,IAAJ,GAAWC,OAAX,GAAqBC,QAArB,CAA8B,EAA9B,IAAoC;AACpCC,EAAAA,IAAI,CAACC,KAAL,CAAW,OAAOD,IAAI,CAACE,MAAL,KAAgB,IAAlC,EAAwCH,QAAxC,CAAiD,EAAjD,CADA,GACuD;AACvD,GAAC,OAAQP,MAAM,GAAG,IAAlB,EAAyBO,QAAzB,CAAkC,CAAlC,CAFA,GAEuC;AACvC,IAJF,EAKEI,KALF,CAKQ,CAAC,EALT,CAFF;AASD,CAXD;;eAaeV;;;ACdf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACpQA;;;;AAEA,SAASW,OAAT,CAAiBC,IAAjB,EAAuB;AACrB;AACA,MAAMC,KAAK,GAAGC,aAAIC,SAAJ,CAAcH,IAAd,CAAd;;AACA,SAAOC,KAAK,CAACG,IAAN,CAAW,MAAX,CAAP;AACD;;eAEcL;;;;;;;;;ACRf,IAAMM,QAAQ,GAAG;AACfC,EAAAA,aAAa;AADE,CAAjB;;AAYe,kBAASC,GAAT,EAAc;AAC3B,SAAOF,QAAQ,CAACE,GAAD,CAAR,sCAA4CA,GAA5C,eAAP;AACD;;;;;;;;;ACdD,SAASC,SAAT,CAAmBC,KAAnB,EAA0B;AACxB,SAAOA,KAAK,CACTC,OADI,CACI,UADJ,EACgB,EADhB,EAEJA,OAFI,CAEI,UAFJ,EAEgB,EAFhB,EAGJC,KAHI,CAGE,GAHF,EAGOC,MAHd;AAID;;eAEcJ;;;;;;;;;;ACPf;;AACA;;AACA;;AACA;;AACA;;;;AAEA,IAAIK,KAAJ;AACA,IAAIC,KAAK,GAAG,CAAZ;AACA,IAAIC,KAAK,GAAG,GAAZ;;AAEA,SAASC,IAAT,GAAgB;AACd,SAAO,IAAIxB,IAAJ,GAAWE,QAAX,GAAsBgB,OAAtB,CAA8B,sBAA9B,EAAsD,IAAtD,CAAP;AACD;;AACD,SAASO,OAAT,GAA+B;AAAA,MAAdC,KAAc,uEAAN,IAAM;AAC7B,MAAMC,EAAE,GAAG,CAAC,SAAD,EAAYD,KAAZ,EAAmBE,MAAnB,CAA0B,UAAAC,GAAG;AAAA,WAAIA,GAAJ;AAAA,GAA7B,EAAsCjB,IAAtC,CAA2C,GAA3C,CAAX;AAEA,SAAO;AACLkB,IAAAA,IAAI,EAAE,gBAAM;AACV,UAAMC,IAAI,GAAGC,YAAY,CAACL,EAAD,CAAZ,IAAoB,IAAjC;AACA,aAAOI,IAAI,IAAIE,IAAI,CAACC,KAAL,CAAWH,IAAX,CAAf;AACD,KAJI;AAMLI,IAAAA,KAAK,EAAE,eAAAC,GAAG,EAAI;AACZC,MAAAA,YAAY,CAAChB,KAAD,CAAZ;AACAC,MAAAA,KAAK,GAAG,CAACA,KAAK,IAAI,CAAV,IAAe,CAAvB;AACAD,MAAAA,KAAK,GAAGiB,UAAU,CAAC,YAAM;AACvBC,QAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiClB,KAAjC,EAAwCE,IAAI,EAA5C,EAAgDY,GAAhD;AACAJ,QAAAA,YAAY,CAACL,EAAD,CAAZ,GAAmBM,IAAI,CAACQ,SAAL,CAAeL,GAAf,CAAnB;AACAd,QAAAA,KAAK,GAAG,CAAR;AACD,OAJiB,EAIfC,KAJe,CAAlB;AAKD;AAdI,GAAP;AAgBD;;eAEc;AACb3B,EAAAA,IAAI,EAAJA,aADa;AAEb8C,EAAAA,SAAS,EAATA,eAFa;AAGbnC,EAAAA,OAAO,EAAPA,gBAHa;AAIbkB,EAAAA,OAAO,EAAPA,OAJa;AAKbkB,EAAAA,OAAO,EAAPA,gBALa;AAMb3B,EAAAA,SAAS,EAATA,kBANa;AAObQ,EAAAA,IAAI,EAAJA;AAPa;;;;;;;;;;;;;;;;;;;;;;;AClCf,SAASoB,KAAT,CAAeC,CAAf,EAAkB;AAChB,MAAIA,CAAC,KAAKC,SAAV,EAAqB;AACrB,SAAOD,CAAP;AACD;;eAEcD;;;;;;;;;;;;;;;;;;;;;;ACLf,IAAMG,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEA,SAASC,iBAAT,CAA2BC,QAA3B,EAAmD;AAAA,MAAdC,OAAc,uEAAJ,EAAI;;AAAA,4CACTJ,QADS,EACII,OADJ;AAAA,MACzCC,WADyC,qBACzCA,WADyC;AAAA,MAC5BC,SAD4B,qBAC5BA,SAD4B;;AAGjD,SAAO,mBAAIH,QAAJ,EAAcI,GAAd,CAAkB,UAAAC,EAAE,EAAI;AAAA,QACrBC,SADqB,GACID,EADJ,CACrBC,SADqB;AAAA,QACVC,SADU,GACIF,EADJ,CACVE,SADU;AAE7B,QAAMC,UAAU,GAAGD,SAAS,CAACE,QAAV,CAAmBN,SAAnB,CAAnB;AACA,QAAMO,MAAM,GAAGF,UAAU,GAAGN,WAAH,GAAiB,EAA1C;AAEA,qBAAUQ,MAAV,SAAmBJ,SAAS,CAACK,IAAV,EAAnB;AACD,GANM,CAAP;AAOD;;eAEcZ;;;;;;;;;;ACdf,SAASa,WAAT,GAAkC;AAAA,MAAbtD,IAAa,uEAAN,IAAM;AAChC;AACA;AACA,MAAI,CAACA,IAAL,EAAW;AAEX,SAAOA,IAAI,CAACW,KAAL,CAAW,KAAX,CAAP,CALgC,CAMhC;AACD;;eAEc2C;;;;;;;;;ACTf,IAAMC,cAAc,GAAG,uBAAvB;;AAEA,SAASC,SAAT,CAAmBxD,IAAnB,EAAgD;AAAA,MAAvByD,aAAuB,uEAAP,KAAO;AAC9C;AACAzD,EAAAA,IAAI,GAAGA,IAAI,IAAIA,IAAI,CAACqD,IAAL,EAAf;AAEA,MAAI,CAACrD,IAAL,EAAW;AAEX,MAAI0D,SAAS,GAAGH,cAAc,CAACI,IAAf,CAAoB3D,IAApB,CAAhB;AACA,MAAIkB,KAAK,GAAGuC,aAAa,IAAI,CAACC,SAAlB,GAA8B,GAA9B,GAAoC,EAAhD;AAEA,mBAAU1D,IAAV,SAAiBkB,KAAjB;AACD;;eAEcsC;;;;;;;;;;ACdf;;AACA;;;;;;;;;;;;AAEA,IAAMI,WAAW,GAAG,qBAApB;;AAEA,SAASC,kBAAT,CAA4BpD,KAA5B,EAA0D;AAAA,MAAvBgD,aAAuB,uEAAP,KAAO;AACxD;AACA;AACA;AAEA,MAAMK,QAAQ,GAAGrD,KAAK,IAAIA,KAAK,CAACsD,WAAN,KAAsBC,KAAhD;AACA,MAAM/D,KAAK,GAAG6D,QAAQ,GAAGrD,KAAH,GAAW,0BAAYA,KAAZ,CAAjC;AACA,SAAO,mBAAIR,KAAJ,EACJ6C,GADI,CACA,UAAAmB,IAAI;AAAA,WACPL,WAAW,CAACD,IAAZ,CAAiBM,IAAjB,IAAyB,IAAzB,GAAgC,wBAAUA,IAAV,EAAgBR,aAAhB,CADzB;AAAA,GADJ,EAIJrC,MAJI,CAIG,UAAAiB,CAAC;AAAA,WAAIA,CAAC,IAAIA,CAAC,CAACzB,MAAX;AAAA,GAJJ,EAKJR,IALI,CAKC,GALD,EAMJiD,IANI,EAAP;AAOD;;eAEcQ;;;;;;;;;;;;;;;;;;ACrBf,IAAMK,OAAO,GAAG,IAAIC,MAAJ,CAAW,QAAX,EAAqB,GAArB,CAAhB;;AAEA,SAASC,WAAT,CAAqBnE,KAArB,EAA4B;AAC1B;AACA;AAEA,SAAO,mBAAIA,KAAJ,EACJ6C,GADI,CACA,UAAA9C,IAAI,EAAI;AACX,QAAM6C,SAAS,GAAGqB,OAAO,CAACP,IAAR,CAAa3D,IAAb,2BAA0C,EAA5D;AACA,QAAMS,KAAK,GAAGT,IAAI,GAAGA,IAAI,CAACU,OAAL,CAAawD,OAAb,EAAsB,EAAtB,EAA0Bb,IAA1B,EAAH,GAAsC,QAAxD;AAEA,yBAAcR,SAAd,cAA2BpC,KAA3B;AACD,GANI,EAOJL,IAPI,CAOC,IAPD,EAQJV,QARI,EAAP;AASD;;eAEc0E;;;AMjBf,IAAI+J,SAAS,GAAG,IAAhB;;AACA,SAASC,kBAAT,GAA8B;AAC5B,MAAI,CAACD,SAAL,EAAgB;AACdA,IAAAA,SAAS,GAAGE,YAAY,EAAxB;AACD;;AAED,SAAOF,SAAP;AACD;;AAED,SAASE,YAAT,GAAwB;AACtB;AACA,MAAI;AACF,UAAM,IAAIC,KAAJ,EAAN;AACD,GAFD,CAEE,OAAOC,GAAP,EAAY;AACZ,QAAIC,OAAO,GAAG,CAAC,KAAKD,GAAG,CAACE,KAAV,EAAiBC,KAAjB,CAAuB,gCAAvB,CAAd;;AACA,QAAIF,OAAJ,EAAa;AACX,aAAOG,UAAU,CAACH,OAAO,CAAC,CAAD,CAAR,CAAjB;AACD;AACF;;AAED,SAAO,GAAP;AACD;;AAED,SAASG,UAAT,CAAoBC,GAApB,EAAyB;AACvB,SAAO,CAAC,KAAKA,GAAN,EAAWlO,OAAX,CAAmB,uCAAnB,EAA4D,IAA5D,IAAoE,GAA3E;AACD;;AAEDmO,OAAO,CAACR,YAAR,GAAuBD,kBAAvB;AACAS,OAAO,CAACF,UAAR,GAAqBA,UAArB;;AC5BA,IAAIG,MAAM,GAAGtM,OAAO,CAAC,cAAD,CAApB;;AAEA,SAASuM,UAAT,CAAoBC,IAApB,EAA0B;AACxB,MAAIC,OAAO,GAAGD,IAAI,CAACE,SAAL,EAAd;;AACAD,EAAAA,OAAO,CAACE,MAAR,GAAiB,YAAY;AAC3BH,IAAAA,IAAI,CAACrI,MAAL;AACD,GAFD;;AAGAsI,EAAAA,OAAO,CAACG,IAAR,GAAeJ,IAAI,CAACI,IAAL,CAAUzO,KAAV,CAAgB,GAAhB,EAAqB,CAArB,IAA0B,GAA1B,GAAgCnB,IAAI,CAAC2M,GAAL,EAA/C;AACA6C,EAAAA,IAAI,CAAC5I,UAAL,CAAgBiJ,YAAhB,CAA6BJ,OAA7B,EAAsCD,IAAI,CAACM,WAA3C;AACD;;AAED,IAAIC,UAAU,GAAG,IAAjB;;AACA,SAASC,SAAT,GAAqB;AACnB,MAAID,UAAJ,EAAgB;AACd;AACD;;AAEDA,EAAAA,UAAU,GAAGzN,UAAU,CAAC,YAAY;AAClC,QAAI2N,KAAK,GAAGxJ,QAAQ,CAACyJ,gBAAT,CAA0B,wBAA1B,CAAZ;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,KAAK,CAAC7O,MAA1B,EAAkC+O,CAAC,EAAnC,EAAuC;AACrC,UAAIb,MAAM,CAACH,UAAP,CAAkBc,KAAK,CAACE,CAAD,CAAL,CAASP,IAA3B,MAAqCN,MAAM,CAACT,YAAP,EAAzC,EAAgE;AAC9DU,QAAAA,UAAU,CAACU,KAAK,CAACE,CAAD,CAAN,CAAV;AACD;AACF;;AAEDJ,IAAAA,UAAU,GAAG,IAAb;AACD,GATsB,EASpB,EAToB,CAAvB;AAUD;;AAEDK,MAAM,CAACf,OAAP,GAAiBW,SAAjB;;;;;;;;;;;;;;AN7BA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA;;;;;;;;;;;;;;;;AAEA;;;;;;;;;;;;;;;;AAiBA,IAAInL,MAAJ;;AACA,IAAIC,MAAM,qBAAQC,gBAAR,CAAV;;AAEA,IAAIC,KAAK,GAAG;AACVC,EAAAA,SAAS,EAAE,IADD;AACO;AACjBC,EAAAA,QAAQ,EAAE,CAAC,IAAD,CAFA,CAEO;;AAFP,CAAZ,EAKA;;AACA,IAAMnB,cAAc,GAAG,uBAAvB;AACA,IAAMK,WAAW,GAAG,qBAApB;AACA7B,OAAO,CAACC,GAAR,CAAYuB,cAAZ;AAEA,IAAMoB,iBAAiB,GAAG;AACxBC,EAAAA,OAAO,EAAEC,aADe;AAExBC,EAAAA,UAAU,EAAEC,aAFY;AAGxBC,EAAAA,QAAQ,EAAED;AAHc,CAA1B,EAMA;;AACA,SAASE,aAAT,GAAyB;AACvBZ,EAAAA,MAAM,CAACa,SAAP,GAAmB,EAAnB;AACAb,EAAAA,MAAM,GAAG,IAAT;AACAG,EAAAA,KAAK,CAACC,SAAN,GAAkB,IAAlB;AACAD,EAAAA,KAAK,CAACE,QAAN,GAAiB,CAAC,IAAD,CAAjB,CAJuB,CAKvB;AACD;;AAED,SAASS,YAAT,CAAsBC,GAAtB,EAA2B;AACzB,MAAI,CAACA,GAAD,IAAQ,CAACA,GAAG,CAACpC,SAAjB,EAA4B;AAC5B,MAAMqC,KAAK,GAAG,wBAAUD,GAAG,CAACpC,SAAd,CAAd;AACAoC,EAAAA,GAAG,CAACE,OAAJ,CAAY9E,SAAZ,GAAwB6E,KAAxB;AACD;;AAED,SAASE,sBAAT,GAAkC;AAChC,MAAIjB,MAAM,CAACkB,aAAX,EAA0B;AACxB,uBAAInB,MAAM,CAAC3B,QAAX,EAAqBI,GAArB,CAAyBqC,YAAzB;AACD;AACF;;AAED,SAASM,IAAT,GAA0C;AAAA,MAA5BhF,KAA4B,uEAApB,IAAoB;AAAA,MAAdkC,OAAc,uEAAJ,EAAI;AACxC,MAAI,CAAClC,KAAL,EAAY;AACZ,MAAI,CAAC4D,MAAL,EAAaqB,UAAU;AAEvB,MAAMzF,KAAK,GAAGQ,KAAK,CAACsD,WAAN,KAAsBC,KAAtB,GAA8BvD,KAA9B,GAAsC,0BAAYA,KAAZ,CAApD;AACA,MAAMkF,IAAI,GAAG,0BAAY1F,KAAZ,CAAb;AAEAqE,EAAAA,MAAM,GAAGsB,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBvB,MAAlB,EAA0B3B,OAA1B,CAAT;AAEA0B,EAAAA,MAAM,CAACa,SAAP,GAAmBS,IAAnB;AACAtB,EAAAA,MAAM,CAACyB,KAAP;AAEAP,EAAAA,sBAAsB;AACtBQ,EAAAA,aAAa;AACb,SAAOJ,IAAP;AACD;;AAED,SAASZ,aAAT,CAAuBiB,IAAvB,EAA6B;AAC3B,MAAI/B,IAAI,GAAGgC,QAAQ,CAACC,YAAT,GAAwBC,SAAxB,CAAkCC,UAA7C;AACA,MAAIpG,IAAI,GAAGiE,IAAI,CAACjB,SAAhB;AACA,MAAIqD,IAAI,GAAG,CAAC,OAAO1C,IAAP,CAAYM,IAAI,CAACqC,QAAjB,CAAD,IAA+B,CAACtG,IAAhC,IAAwC,CAACA,IAAI,CAACqD,IAAL,EAApD;AAEA,MAAIgD,IAAJ,EAAU;AAEVpC,EAAAA,IAAI,CAAChB,SAAL,CAAesD,MAAf,CAAsB,SAAtB;AACD;;AAED,SAAS1B,aAAT,CAAuB2B,IAAvB,EAA6B;AAC3B,qBAAIA,IAAJ,EAAUC,OAAV,CAAkB,UAACrB,GAAD,EAAMsB,CAAN,EAAY;AAC5B,QAAM1G,IAAI,GAAIoF,GAAG,CAACpC,SAAJ,IAAiBoC,GAAG,CAACpC,SAAJ,CAAcK,IAAd,EAAlB,IAA2C,IAAxD;AACArD,IAAAA,IAAI,GAAGoF,GAAH,GAASA,GAAG,CAACnC,SAAJ,CAAc0D,MAAd,CAAqB,SAArB,CAAb;AACD,GAHD;AAID;;AAED,SAASC,eAAT,CAAyBC,CAAzB,EAA4BC,OAA5B,EAAqCC,UAArC,EAAiD;AAAA,MACvCX,UADuC,GACxBY,MAAM,CAACd,YAAP,GAAsBC,SADE,CACvCC,UADuC;AAE/C,MAAM1D,QAAQ,GAAG0D,UAAU,CAAC1D,QAA5B;AAEAqE,EAAAA,UAAU,GAAGA,UAAU,CAAC3G,IAAX,CAAgB,EAAhB,EAAoBb,WAApB,EAAb;AAJ+C,MAMvCqF,OANuC,GAMhBD,iBANgB,CAMvCC,OANuC;AAAA,MAM9BqC,SAN8B,GAMhBtC,iBANgB,CAM9BsC,SAN8B;;AAO/C,MAAMC,OAAO,GACXvC,iBAAiB,CAACoC,UAAD,CAAjB,IACApC,iBAAiB,aAAMoC,UAAN,EADjB,IAEA3E,cAHF;;AAKAwC,EAAAA,OAAO,CAAClC,QAAD,CAAP;AACAwE,EAAAA,OAAO,CAACd,UAAD,CAAP;AACAjB,EAAAA,YAAY,CAACiB,UAAD,CAAZ;AACAL,EAAAA,aAAa;AACd;;AAED,SAASoB,UAAT,GAAsB;AACpB,MAAIC,EAAE,GAAG,CAAT;AACA,MAAIC,IAAI,GAAG,EAAX;;AAEAhD,EAAAA,MAAM,CAACiD,OAAP,GAAiB,UAAAT,CAAC,EAAI;AAAA,kBACcvC,MADd;AAAA,QACZiD,SADY,WACZA,SADY;AAAA,QACDC,UADC,WACDA,UADC;AAEpB,QAAMC,IAAI,GAAGZ,CAAC,CAACa,SAAF,GAAcN,EAA3B;AACA,QAAMrG,KAAK,GAAG0G,IAAI,GAAGF,SAArB;AACAH,IAAAA,EAAE,GAAGP,CAAC,CAACa,SAAP;AAEAL,IAAAA,IAAI,GAAGI,IAAI,GAAGD,UAAP,GAAoB,EAApB,GAAyBH,IAAhC;AAEAA,IAAAA,IAAI,CAACM,IAAL,CAAUd,CAAC,CAACtG,GAAZ;AACA8G,IAAAA,IAAI,GAAGA,IAAI,CAACvH,KAAL,CAAW,CAAC,CAAZ,CAAP;AAEAgC,IAAAA,UAAU,CAAC;AAAA,aAAM8E,eAAe,CAACC,CAAD,EAAI9F,KAAJ,EAAWsG,IAAX,CAArB;AAAA,KAAD,EAAwC,CAAxC,CAAV;AACD,GAZD;AAaD;;AAED,SAASO,eAAT,GAA2B;AACzB,MAAMjF,OAAO,qBAAQ2B,MAAR,CAAb;;AACA,SAAO,gCAAkBD,MAAM,CAAC3B,QAAzB,EAAmCC,OAAnC,CAAP;AACD;;AAED,SAASoD,aAAT,GAAyB;AACvB;AACA;AACA;AAHuB,gBAIF1B,MAJE;AAAA,MAIf3B,QAJe,WAIfA,QAJe;;AAAA,iCAKc8B,KALd;AAAA,MAKfC,SALe,UAKfA,SALe;AAAA,MAKJC,QALI,UAKJA,QALI;;AAAA,iBAMFJ,MANE;AAAA,MAMfuD,QANe,YAMfA,QANe;AAOvB,MAAMC,MAAM,GAAG,gCAAkBpF,QAAlB,CAAf;AAEA,MAAMqF,aAAa,GAAG1I,MAAM,CAAC,iCAAmByI,MAAnB,CAAD,CAA5B;;AACA,MAAME,YAAY,sBAAOJ,eAAe,EAAtB,CAAlB,CAVuB,CAYvB;;;AACA,MAAMK,CAAC,GAAGxD,SAAS,KAAKsD,aAAxB;AACA,MAAMG,CAAC,GAAGD,CAAC,IAAIvD,QAAQ,CAAC9D,MAAT,KAAoBoH,YAAY,CAACpH,MAAhD,CAduB,CAgBvB;;AACA,MAAMuH,OAAO,GACXD,CAAC,IAAIxD,QAAQ,CAAC0D,IAAT,GAAgBhI,IAAhB,CAAqB,EAArB,MAA6B4H,YAAY,CAACI,IAAb,GAAoBhI,IAApB,CAAyB,EAAzB,CADpC,CAjBuB,CAoBvB;;AACA,MAAI+H,OAAJ,EAAa;AACX3D,IAAAA,KAAK,GAAG;AACNC,MAAAA,SAAS,EAAEsD,aADL;AAENrD,MAAAA,QAAQ,EAAEsD;AAFJ,KAAR;AAIAH,IAAAA,QAAQ,CAACE,aAAD,EAAgBC,YAAhB,CAAR;AACD;AACF;;AAED,SAASK,WAAT,CAAqBC,EAArB,EAAyB;AACvBhE,EAAAA,MAAM,GAAGsB,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBvB,MAAlB,EAA0B;AAAEuD,IAAAA,QAAQ,EAAES;AAAZ,GAA1B,CAAT;AACD;;AAED,SAASpB,OAAT,CAAiB3G,GAAjB,EAAsBgI,QAAtB,EAAgC;AAC9B,MAAMC,EAAE,GAAG7D,iBAAiB,CAACpE,GAAD,CAAjB,eAA8BA,GAA9B,IAAsCA,GAAjD;AACAoE,EAAAA,iBAAiB,CAAC6D,EAAD,CAAjB,GAAwBD,QAAxB;AACAxG,EAAAA,OAAO,CAACC,GAAR,CAAY,oBAAZ,EAAkCwG,EAAlC,EAAsCjI,GAAtC;AACD;;AAED,SAASmF,UAAT,GAA8C;AAAA,MAA1B+C,QAA0B,uEAAf,IAAe;AAAA,MAAT9F,OAAS;AAC5C2B,EAAAA,MAAM,CAACmE,QAAP,GAAkBnE,MAAM,CAACmE,QAAP,IAAmBA,QAArC;AACApE,EAAAA,MAAM,GAAG4B,QAAQ,CAACyC,aAAT,CAAuBpE,MAAM,CAACmE,QAA9B,CAAT;;AAEA,MAAI,CAACpE,MAAL,EAAa;AACX,iDAAsCoE,QAAtC;AACD;;AAED,MAAI9F,OAAJ,EAAa;AACX2B,IAAAA,MAAM,GAAGsB,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBvB,MAAlB,EAA0B3B,OAA1B,CAAT;AACD;;AAEDwE,EAAAA,UAAU;AACV,SAAO;AACL1B,IAAAA,IAAI,EAAJA,IADK;AAELyB,IAAAA,OAAO,EAAPA,OAFK;AAGLyB,IAAAA,KAAK,EAAE1D,aAHF;AAIL1C,IAAAA,QAAQ,EAAE;AAAA,aAAM+B,MAAN;AAAA,KAJL;AAKLuD,IAAAA,QAAQ,EAAEQ,WALL;AAML5D,IAAAA,SAAS,EAAEZ,2BANN;AAOLa,IAAAA,QAAQ,EAAEjC;AAPL,GAAP;AASD;;eAEciD;;;;;;;;;;AC/Mf;;;;;;;;AAEA,IAAIkD,CAAJ;AACA,IAAIC,CAAJ;AACA,IAAIC,IAAJ;AACA,IAAIC,QAAJ;AACA,IAAIC,QAAQ,GAAG,KAAf;;iBACwBC,mBAAEhI,OAAF,CAAU,SAAV;IAAhBK,kBAAAA;IAAMK,mBAAAA;;AAEd,IAAIuH,KAAK,GAAGtD,MAAM,CAACC,MAAP,CACV,EADU,EAEV;AACEsD,EAAAA,KAAK,EAAE,EADT;AACa;AACXC,EAAAA,QAAQ,EAAE,CAFZ;AAEe;AACbC,EAAAA,SAAS,EAAE,EAHb;AAGiB;AAEf;AACAN,EAAAA,QAAQ,EAAE,WANZ;AAOE9C,EAAAA,QAAQ,EAAE,WAPZ;AAQE9F,EAAAA,SAAS,EAAE;AARb,CAFU,EAYVmB,IAAI,EAZM,CAAZ;;AAeA,SAASgI,IAAT,GAAwB;AAAA,MAAV1H,GAAU,uEAAJ,EAAI;;AACtB,MAAML,IAAI,qBAAQ2H,KAAR,EAAkBtH,GAAlB,CAAV;;AACAD,EAAAA,KAAK,CAACJ,IAAD,CAAL;AACA,SAAOK,GAAP;AACD;;AAED,SAASW,QAAT,CAAkBhC,GAAlB,EAAuBE,KAAvB,EAA8B;AAC5B,MAAI,CAACF,GAAL,EAAU,OADkB,CAG5B;;AACA,MAAMgJ,IAAI,GAAG,EAAb;;AACA,MAAIhJ,GAAG,CAACwD,WAAJ,KAAoB6B,MAApB,IAA8BnF,KAAK,KAAK6B,SAA5C,EAAuD;AACrDiH,IAAAA,IAAI,CAAChJ,GAAD,CAAJ,GAAYE,KAAZ;AACAF,IAAAA,GAAG,qBAAQgJ,IAAR,CAAH;AACD;;AAEDL,EAAAA,KAAK,qBAAQA,KAAR;AAAe3I,IAAAA,GAAG,EAAHA;AAAf,IAAL;AACA,SAAO+I,IAAI,CAACJ,KAAD,CAAX;AACD;;AAED,SAASM,MAAT,CAAgB3C,CAAhB,EAAmBpG,KAAnB,EAA0B;AACxB,MAAI,CAACuI,QAAD,IAAa,CAACvI,KAAlB,EAAyB;;AADD,aAGRoG,CAAC,IAAI,EAHG;AAAA,MAGlB4C,KAHkB,QAGlBA,KAHkB;;AAKxB,MAAI5C,CAAJ,EAAO;AACL;AACAA,IAAAA,CAAC,CAAC6C,eAAF,IAAqB7C,CAAC,CAAC6C,eAAF,EAArB;AACA7C,IAAAA,CAAC,CAAC8C,cAAF,IAAoB9C,CAAC,CAAC8C,cAAF,EAApB;AACA9C,IAAAA,CAAC,CAAC+C,YAAF,GAAiB,IAAjB;AACA/C,IAAAA,CAAC,CAACgD,WAAF,GAAgB,KAAhB;AACD;;AAXuB,eAaQX,KAbR;AAAA,MAahBG,SAbgB,UAahBA,SAbgB;AAAA,MAaLD,QAbK,UAaLA,QAbK;AAAA,gBAcDpC,MAdC;AAAA,MAchB8C,UAdgB,WAchBA,UAdgB;AAgBxBL,EAAAA,KAAK,GAAGA,KAAK,IAAK,CAAChJ,KAAK,IAAI,EAAV,IAAgB,GAAjB,GAAwBqJ,UAAzC;AACA,MAAIX,KAAK,GAAG1I,KAAK,IAAIsJ,MAAM,CAAEN,KAAK,GAAGK,UAAT,GAAuB,GAAxB,CAA3B;AACAX,EAAAA,KAAK,GAAGxJ,IAAI,CAACqK,GAAL,CAASZ,QAAT,EAAmBD,KAAnB,CAAR;AACAA,EAAAA,KAAK,GAAGxJ,IAAI,CAACsK,GAAL,CAAS,MAAMb,QAAf,EAAyBD,KAAzB,CAAR;AAEA,MAAIe,OAAO,GAAGf,KAAd;AACAP,EAAAA,CAAC,CAAC3F,SAAF,CAAY0D,MAAZ,CAAmB,cAAnB;AACAkC,EAAAA,CAAC,CAAC5F,SAAF,CAAY0D,MAAZ,CAAmB,cAAnB;AACAoC,EAAAA,QAAQ,CAAC9F,SAAT,CAAmB0D,MAAnB,CAA0B,gBAA1B;AACAoC,EAAAA,QAAQ,CAAC9F,SAAT,CAAmB0D,MAAnB,CAA0B,iBAA1B;;AAEA,MAAIwC,KAAK,GAAGE,SAAZ,EAAuB;AACrB;AACAa,IAAAA,OAAO,GAAG,OAAOd,QAAQ,GAAGU,UAAlB,CAAV;AACAlB,IAAAA,CAAC,CAAC3F,SAAF,CAAYkH,GAAZ,CAAgB,cAAhB;AACApB,IAAAA,QAAQ,CAAC9F,SAAT,CAAmBkH,GAAnB,CAAuB,gBAAvB;AACD;;AACD,MAAIhB,KAAK,GAAG,MAAME,SAAlB,EAA6B;AAC3Ba,IAAAA,OAAO,GAAG,MAAM,OAAQd,QAAQ,GAAG,GAAZ,GAAmBU,UAA1B,CAAhB;AACAjB,IAAAA,CAAC,CAAC5F,SAAF,CAAYkH,GAAZ,CAAgB,cAAhB;AACApB,IAAAA,QAAQ,CAAC9F,SAAT,CAAmBkH,GAAnB,CAAuB,iBAAvB;AACD;;AAEDvB,EAAAA,CAAC,CAACwB,KAAF,CAAQjB,KAAR,aAAmBe,OAAnB;AACArB,EAAAA,CAAC,CAACuB,KAAF,CAAQjB,KAAR,aAAmB,MAAMe,OAAzB;AACAnB,EAAAA,QAAQ,CAACqB,KAAT,CAAetB,IAAf,aAAyBoB,OAAzB;AAEAZ,EAAAA,IAAI,CAAC;AAAEH,IAAAA,KAAK,EAAEY,MAAM,CAACG,OAAD;AAAf,GAAD,CAAJ;AACD;;AAED,SAASG,cAAT,GAA0B;AACxBvB,EAAAA,IAAI,CAACwB,OAAL,GAAe,UAAAzD,CAAC,EAAI;AAAA,oBACYA,CAAC,CAAC0D,MADd;AAAA,QACVjE,QADU,aACVA,QADU;AAAA,QACAhB,OADA,aACAA,OADA;AAElB,QAAIgB,QAAQ,KAAK,IAAjB,EAAuB;AACvBvE,IAAAA,OAAO,CAACC,GAAR,CAAYsE,QAAZ,EAAsBhB,OAAO,CAACgD,EAA9B;AACA,QAAMA,EAAE,GAAGhD,OAAO,CAACgD,EAAnB;AACAtB,IAAAA,MAAM,CAACwD,EAAP,CAAUC,OAAV,CAAkBnC,EAAlB;AACD,GAND;AAOD;;AAED,SAAS5C,UAAT,GAAkC;AAAA,MAAd/C,OAAc,uEAAJ,EAAI;AAChCoG,EAAAA,QAAQ,GAAG9C,QAAQ,CAACyC,aAAT,CAAuBQ,KAAK,CAACH,QAA7B,CAAX;AACAD,EAAAA,IAAI,GAAG7C,QAAQ,CAACyC,aAAT,CAAuB,YAAvB,CAAP;AACAE,EAAAA,CAAC,GAAG3C,QAAQ,CAACyC,aAAT,CAAuBQ,KAAK,CAACjD,QAA7B,CAAJ;AACA4C,EAAAA,CAAC,GAAG5C,QAAQ,CAACyC,aAAT,CAAuBQ,KAAK,CAAC/I,SAA7B,CAAJ;AAEAkK,EAAAA,cAAc;;AAEdtB,EAAAA,QAAQ,CAAC2B,WAAT,GAAuB;AAAA,WAAO1B,QAAQ,GAAG,IAAlB;AAAA,GAAvB;;AACAD,EAAAA,QAAQ,CAAC4B,UAAT,GAAsB,UAAA9D,CAAC;AAAA,WAAI2C,MAAM,CAAC3C,CAAD,EAAI,EAAJ,CAAV;AAAA,GAAvB;;AAEAG,EAAAA,MAAM,CAAC4D,SAAP,GAAmB,YAAM;AACvB5B,IAAAA,QAAQ,GAAG,KAAX;AACAjH,IAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BkH,KAAK,CAACC,KAAjC;AACD,GAHD;;AAKAnC,EAAAA,MAAM,CAAC6D,WAAP,GAAqBrB,MAArB;AAEAF,EAAAA,IAAI,CAAC3G,OAAD,CAAJ;AACA6G,EAAAA,MAAM,CAAC,IAAD,EAAON,KAAK,CAACC,KAAb,CAAN;AAEApH,EAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ;AAEA,SAAO;AAAEwH,IAAAA,MAAM,EAANA,MAAF;AAAUjH,IAAAA,QAAQ,EAARA;AAAV,GAAP;AACD;;eAEcmD;;;;;;;;;;AC9Hf;;AACA;;;;AAEA,SAASoF,gBAAT,CAA0B7K,KAA1B,EAAiC;AAC/B;AACA;AACA;AAEA,MAAI,CAACA,KAAL,EAAY;AAEZ,MAAM0F,IAAI,GAAG1F,KAAK,CAAC6C,GAAN,CAAU,UAAAsC,GAAG,EAAI;AAAA,oBACSA,GADT,CACpBpF,IADoB;AAAA,QACpBA,IADoB,0BACb,EADa;AAAA,wBACSoF,GADT,CACTV,QADS;AAAA,QACTA,QADS,8BACE,EADF;AAG5B,QAAM8D,EAAE,GAAG9D,QAAQ,GAAG,oBAAH,GAAY,EAA/B;AACA,QAAMqG,SAAS,GAAIrG,QAAQ,IAAI,QAAb,IAA0B,EAA5C;AACA,QAAMjE,KAAK,GAAGT,IAAI,IAAK0E,QAAQ,IAAI,iCAAmBA,QAAnB,CAArB,IAAsD,EAApE;AACA,QAAMsG,IAAI,GAAGtG,QAAQ,GAAGjD,IAAI,CAACQ,SAAL,CAAeyC,QAAf,CAAH,GAA8B,EAAnD,CAN4B,CAQ5B;AACA;;AACA,QAAMuG,GAAG,GAAGhF,QAAQ,CAACiF,aAAT,CAAuB,KAAvB,CAAZ,CAV4B,CAY5B;;AACA1C,IAAAA,EAAE,KAAKyC,GAAG,CAACzC,EAAJ,GAASA,EAAd,CAAF;AACAuC,IAAAA,SAAS,KAAKE,GAAG,CAACpI,SAAJ,GAAgBkI,SAArB,CAAT;AACArG,IAAAA,QAAQ,KAAKuG,GAAG,CAAC3F,OAAJ,CAAYZ,QAAZ,GAAuBsG,IAA5B,CAAR;AAEAC,IAAAA,GAAG,CAAC/F,SAAJ,GAAgBzE,KAAK,IAAI,OAAzB;AAEA,WAAOwK,GAAG,CAACE,SAAX;AACD,GApBY,CAAb;AAsBA,SAAOxF,IAAI,CAACvF,IAAL,CAAU,IAAV,CAAP;AACD;;eAEc0K;;;;;;;;;;;;;;;;;;ACnCf;;AACA;;AACA;;;;;;;;;;;;;;;;AAEA,IAAIL,OAAJ;AACA,IAAIW,QAAJ;AACA,IAAIvK,KAAJ;AACA,IAAIE,KAAK,GAAG,IAAZ;;AAEA,IAAMsK,MAAM,GAAG7I,OAAO,CAAC,gBAAD,CAAtB;;iBACwByG,mBAAEhI,OAAF,CAAU,SAAV;IAAhBK,kBAAAA;IAAMK,mBAAAA;;AAEd,IAAM2J,SAAS,GAAG;AAChBC,EAAAA,KAAK,EAAE,iBAAM,CAAE,CADC;AAEhBC,EAAAA,QAAQ,EAAE,oBAAM,CAAE;AAFF,CAAlB;;AAKA,SAASjD,QAAT,CAAkBhI,GAAlB,EAAuB+H,EAAvB,EAA2B;AACzBgD,EAAAA,SAAS,CAAC/K,GAAG,CAAChB,WAAJ,EAAD,CAAT,GAA+B+I,EAA/B;AACD;;AAED,SAASmD,aAAT,CAAuB5E,CAAvB,EAA0B;AACxB;AACAyC,EAAAA,IAAI;AACL;;AAED,SAASoC,WAAT,CAAqB7E,CAArB,EAAwB;AACtB;AACA,MAAIuE,QAAJ,EAAc;AACZA,IAAAA,QAAQ,CAACnI,SAAT,CAAmB0D,MAAnB,CAA0B,UAA1B;AACD,GAJqB,CAMtB;;;AANsB,kBAOAE,CAAC,CAAC0D,MAPF;AAAA,MAOhB/B,EAPgB,aAOhBA,EAPgB;AAAA,MAOZlD,OAPY,aAOZA,OAPY;AAQtB,MAAI,CAACkD,EAAD,IAAO,CAAClD,OAAO,CAACZ,QAApB,EAA8B;AAE9B0G,EAAAA,QAAQ,GAAGnF,QAAQ,CAACyC,aAAT,YAA2BF,EAA3B,EAAX;AACA4C,EAAAA,QAAQ,CAACnI,SAAT,CAAmBkH,GAAnB,CAAuB,UAAvB;AACAiB,EAAAA,QAAQ,CAAC9F,OAAT,CAAiB9E,SAAjB,GAA6ByI,mBAAEzI,SAAF,CAAYqG,CAAC,CAAC0D,MAAF,CAASvH,SAArB,CAA7B;AAZsB,MAcd0B,QAdc,GAcDY,OAdC,CAcdZ,QAdc;AAetB,MAAMsG,IAAI,GAAGtG,QAAQ,IAAIjD,IAAI,CAACC,KAAL,CAAWgD,QAAX,CAAzB;AAEA4G,EAAAA,SAAS,CAACC,KAAV,CAAgBP,IAAhB,EAAsBI,QAAtB;AACD;;AAED,SAASO,iBAAT,CAA2B9E,CAA3B,EAA8B;AAC5BA,EAAAA,CAAC,CAAC0D,MAAF,CAAS/B,EAAT,GAAc3B,CAAC,CAAC0D,MAAF,CAAS/B,EAAT,IAAeS,mBAAE7J,IAAF,EAA7B;AAD4B,mBAEKyH,CAAC,CAAC0D,MAFP;AAAA,MAEtB/B,EAFsB,cAEtBA,EAFsB;AAAA,MAElBxF,SAFkB,cAElBA,SAFkB;AAAA,MAEPsC,OAFO,cAEPA,OAFO;AAAA,MAGpBZ,QAHoB,GAGPY,OAHO,CAGpBZ,QAHoB;;AAI5B,MAAM1E,IAAI,GAAGiJ,mBAAElJ,OAAF,CAAUiD,SAAV,CAAb;;AACA,MAAMvC,KAAK,GAAIiE,QAAQ,IAAIjD,IAAI,CAACC,KAAL,CAAWgD,QAAX,CAAb,IAAsC1E,IAAtC,IAA8C,EAA5D;;AAEA,MAAI0E,QAAJ,EAAc;AACZ;AACA,QAAI,CAACsC,MAAM,CAAC4E,OAAP,CAAe3C,mBAAE9G,OAAF,CAAU,eAAV,CAAf,CAAL,EAAiD,OAFrC,CAIZ;;AACAiJ,IAAAA,QAAQ,CAAC5C,EAAT,GAAc,EAAd;AACA4C,IAAAA,QAAQ,GAAG,IAAX,CANY,CAQZ;;AACAvE,IAAAA,CAAC,CAAC0D,MAAF,CAAS1H,SAAT,GAAqB,EAArB;AACAgE,IAAAA,CAAC,CAAC0D,MAAF,CAAS/B,EAAT,GAAc,EAAd;AACA3B,IAAAA,CAAC,CAAC0D,MAAF,CAASjF,OAAT,CAAiBZ,QAAjB,GAA4B,EAA5B,CAXY,CAaZ;;AACA3C,IAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BoJ,QAA1B;AACAE,IAAAA,SAAS,CAACE,QAAV,CAAmB/K,KAAnB,EAA0B,IAA1B;AACA;AACD;;AAED2K,EAAAA,QAAQ,GAAGnF,QAAQ,CAACyC,aAAT,YAA2BF,EAA3B,EAAX;AACA4C,EAAAA,QAAQ,CAACvI,SAAT,GAAqB,iBAArB;AACAyI,EAAAA,SAAS,CAACE,QAAV,CAAmB/K,KAAnB,EAA0B2K,QAA1B;AACD;;AAED,SAASS,IAAT,GAAgB;AACd,MAAMtK,IAAI,GAAGD,IAAI,EAAjB;AADc,MAENwK,QAFM,GAEOvK,IAFP,CAENuK,QAFM;AAGd,MAAMC,IAAI,GAAGnG,MAAM,CAACmG,IAAP,CAAYD,QAAZ,CAAb;AACA,MAAMD,IAAI,GAAGE,IAAI,CAACjJ,GAAL,CAAS,UAACT,CAAD,EAAIqE,CAAJ;AAAA,qBAAaA,CAAb,eAAmBrE,CAAnB,eAAyByJ,QAAQ,CAACzJ,CAAD,CAAR,CAAY2J,IAArC;AAAA,GAAT,EAAsD5L,IAAtD,CAA2D,IAA3D,CAAb;AACA2B,EAAAA,OAAO,CAACC,GAAR,CAAY6J,IAAZ;AACA,SAAOE,IAAP;AACD;;AAED,SAASE,gBAAT,CAA0BvJ,QAA1B,EAAoC;AAClC,SAAO,mBAAIA,QAAJ,EAAcI,GAAd,CAAkB,UAAAC,EAAE,EAAI;AAAA,wBACOA,EADP,CACrBC,SADqB;AAAA,QACrBA,SADqB,8BACT,EADS;AAAA,QACLsC,OADK,GACOvC,EADP,CACLuC,OADK;AAE7B,QAAMZ,QAAQ,GAAGY,OAAO,CAACZ,QAAR,IAAoBjD,IAAI,CAACC,KAAL,CAAW4D,OAAO,CAACZ,QAAnB,CAArC;AAEA,WAAO;AACL1E,MAAAA,IAAI,EAAEgD,SAAS,CAACK,IAAV,EADD;AAELqB,MAAAA,QAAQ,EAAEA;AAFL,KAAP;AAID,GARM,CAAP;AASD;;AAED,SAAS4E,IAAT,GAAgB;AACdzI,EAAAA,KAAK,IAAIgB,YAAY,CAAChB,KAAD,CAArB;AACAA,EAAAA,KAAK,GAAGiB,UAAU,CAAC,YAAM;AACvB,QAAMoK,UAAU,GAAGD,gBAAgB,CAACxB,OAAO,CAAC/H,QAAT,CAAnC;AACA,QAAMnB,IAAI,GAAGD,IAAI,EAAjB;AACA,QAAM6K,GAAG,GAAG,IAAI3M,IAAJ,GAAWC,OAAX,EAAZ;AAHuB,QAIf2M,OAJe,GAIH7K,IAJG,CAIf6K,OAJe;AAKvBxG,IAAAA,MAAM,CAACC,MAAP,CAActE,IAAI,CAACuK,QAAL,CAAcM,OAAd,CAAd,EAAsC;AAAE7K,MAAAA,IAAI,EAAE2K,UAAR;AAAoBG,MAAAA,MAAM,EAAEF;AAA5B,KAAtC;AACAxK,IAAAA,KAAK,CAACJ,IAAD,CAAL;AACD,GAPiB,EAOfR,KAPe,CAAlB;AAQD;;AAED,SAASuL,MAAT,CAAgB/L,GAAhB,EAAqBgB,IAArB,EAA2ByK,IAA3B,EAAiC;AAC/B,MAAMxD,EAAE,GAAGjI,GAAG,IAAI0I,mBAAE7J,IAAF,EAAlB;;AACA,MAAMmN,OAAO,GAAG,IAAI/M,IAAJ,GAAWC,OAAX,EAAhB;AACA,SAAO;AAAE+I,IAAAA,EAAE,EAAFA,EAAF;AAAMwD,IAAAA,IAAI,EAAJA,IAAN;AAAYzK,IAAAA,IAAI,EAAJA,IAAZ;AAAkBgL,IAAAA,OAAO,EAAPA;AAAlB,GAAP;AACD;;AAED,SAASC,IAAT,GAAgB;AACd,MAAMT,IAAI,GAAGF,IAAI,EAAjB;AACA,MAAMY,KAAK,GAAGzF,MAAM,CAAC0F,MAAP,CAAc,aAAd,CAAd;AACAjH,EAAAA,IAAI,CAACsG,IAAI,CAAChC,MAAM,CAAC0C,KAAD,CAAP,CAAL,CAAJ;AACD;;AAED,SAAShH,IAAT,CAAclF,GAAd,EAAmByL,IAAnB,EAAyBE,UAAzB,EAAqC;AACnC,MAAI1D,EAAJ;AACA,MAAIjH,IAAI,GAAGD,IAAI,EAAf;AACA,MAAI8K,OAAO,GAAG,IAAd;AACA,MAAMhF,EAAE,GAAG,IAAI5H,IAAJ,GAAWC,OAAX,EAAX;;AAEA,MAAI,CAAC8B,IAAL,EAAW;AACT,QAAMoL,SAAS,GAAGL,MAAM,CAAC,IAAD,EAAOjB,MAAP,EAAe,UAAf,CAAxB;AACA7C,IAAAA,EAAE,GAAGmE,SAAS,CAACnE,EAAf;AACAjH,IAAAA,IAAI,GAAG;AAAEuK,MAAAA,QAAQ,EAAE;AAAZ,KAAP;AACAvK,IAAAA,IAAI,CAACuK,QAAL,CAActD,EAAd,sBAAyBmE,SAAzB;AACD,GAXkC,CAanC;;;AACA,MAAIpM,GAAG,IAAIgB,IAAI,CAACuK,QAAL,CAAcvL,GAAd,CAAX,EAA+BiI,EAAE,GAAGjI,GAAL,CAdI,CAgBnC;;AACA,MAAI,CAACiI,EAAD,KAAQjI,GAAG,IAAIyL,IAAP,IAAeE,UAAvB,CAAJ,EAAwC;AACtC1D,IAAAA,EAAE,GAAGjI,GAAG,IAAI0I,mBAAE7J,IAAF,EAAZ;AACA4M,IAAAA,IAAI,GAAGA,IAAI,IAAI,cAAf;AACAE,IAAAA,UAAU,GAAGA,UAAU,IAAI,CAAC;AAAElM,MAAAA,IAAI,EAAEgM;AAAR,KAAD,CAA3B;AACAzK,IAAAA,IAAI,CAACuK,QAAL,CAActD,EAAd,IAAoB8D,MAAM,CAAC9D,EAAD,EAAK0D,UAAL,EAAiBF,IAAjB,CAA1B;AACAjK,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBT,IAAI,CAACuK,QAAxB;AACD,GAvBkC,CAyBnC;;;AACA,MAAI,CAACtD,EAAD,IAAOjH,IAAI,CAAC6K,OAAZ,IAAuB7K,IAAI,CAACuK,QAAL,CAAcvK,IAAI,CAAC6K,OAAnB,CAA3B,EAAwD5D,EAAE,GAAGjH,IAAI,CAAC6K,OAAV,CA1BrB,CA4BnC;;AACA,MAAI,CAAC5D,EAAL,EAASA,EAAE,GAAG5C,MAAM,CAACmG,IAAP,CAAYxK,IAAI,CAACuK,QAAjB,EAA2B,CAA3B,CAAL;AAETM,EAAAA,OAAO,GAAG7K,IAAI,CAACuK,QAAL,CAActD,EAAd,CAAV;AACA4D,EAAAA,OAAO,CAACC,MAAR,GAAiBjF,EAAjB;AACA7F,EAAAA,IAAI,CAAC6K,OAAL,GAAe5D,EAAf,CAjCmC,CAmCnC;AACA;;AACAiC,EAAAA,OAAO,CAACvF,SAAR,GAAoB,+BAAiBkH,OAAO,CAAC7K,IAAzB,CAApB;AACAI,EAAAA,KAAK,mBAAMJ,IAAN,EAAL;AACD;;AAED,SAASqL,MAAT,CAAgBnI,SAAhB,EAA2BC,QAA3B,EAAqC;AACnC;AACA,MAAI,CAAC0G,QAAL,EAAe;AACbrJ,IAAAA,OAAO,CAAC8K,KAAR,CAAc,2BAAd;AACA;AACD;;AAEDzB,EAAAA,QAAQ,CAACpI,SAAT,GAAqByB,SAArB;AACA2G,EAAAA,QAAQ,CAAC9F,OAAT,CAAiB9E,SAAjB,GAA6ByI,mBAAEzI,SAAF,CAAYiE,SAAZ,CAA7B;AACA2G,EAAAA,QAAQ,CAAC9F,OAAT,CAAiBZ,QAAjB,GAA4BjD,IAAI,CAACQ,SAAL,CAAeyC,QAAf,CAA5B;AAEA4E,EAAAA,IAAI;AACL;;AAED,SAASwD,UAAT,CAAoBC,OAApB,EAA6B;AAC3B,MAAIC,MAAJ;AACA,MAAId,UAAJ;AACA,MAAIlM,IAAI,GAAG+M,OAAO,IAAI/F,MAAM,CAAC0F,MAAP,CAAc,0BAAd,CAAtB;;AAEA,MAAI;AACFM,IAAAA,MAAM,GAAGvL,IAAI,CAACC,KAAL,CAAW1B,IAAX,CAAT;AACD,GAFD,CAEE,OAAO6G,CAAP,EAAU;AACV9E,IAAAA,OAAO,CAAC8K,KAAR,CAAc,mBAAd,EAAmChG,CAAnC;AACD,GAT0B,CAW3B;;;AACA,MAAI,CAACmG,MAAL,EAAa;AACXd,IAAAA,UAAU,GAAG,0BAAYlM,IAAZ,CAAb;AACAkM,IAAAA,UAAU,CAACpJ,GAAX,CAAe,UAAAsC,GAAG,EAAI;AACpBpF,MAAAA,IAAI,EAAEoF,GAAG,CAAC/B,IAAJ;AACP,KAFD;AAIA2J,IAAAA,MAAM,GAAG;AACPxE,MAAAA,EAAE,EAAES,mBAAE7J,IAAF,EADG;AAEP4M,MAAAA,IAAI,EAAE,iBAFC;AAGPzK,MAAAA,IAAI,qBAAM2K,UAAN;AAHG,KAAT;AAKD,GAvB0B,CAyB3B;AACA;;;AA1B2B,gBA4BCc,MA5BD;AAAA,MA4BnBzM,GA5BmB,WA4BnBA,GA5BmB;AAAA,MA4BdyL,IA5Bc,WA4BdA,IA5Bc;AAAA,MA4BRzK,IA5BQ,WA4BRA,IA5BQ;AA8B3BkE,EAAAA,IAAI,CAAClF,GAAD,EAAMyL,IAAN,EAAYzK,IAAZ,CAAJ;AACD;;AAED,SAAS0L,UAAT,GAAsB;AACpB,MAAMC,KAAK,GAAG5L,IAAI,EAAlB;AADoB,MAEZ8K,OAFY,GAEAc,KAFA,CAEZd,OAFY;AAAA,8BAGCc,KAAK,CAACpB,QAAN,CAAeM,OAAf,CAHD;AAAA,MAGZ5D,EAHY,yBAGZA,EAHY;AAAA,MAGRwD,IAHQ,yBAGRA,IAHQ;AAIpB,MAAMmB,QAAQ,aAAMnB,IAAN,cAAcxD,EAAd,CAAd;AACA,MAAMxI,IAAI,GAAGyB,IAAI,CAACQ,SAAL,CAAeiL,KAAK,CAACpB,QAAN,CAAeM,OAAf,CAAf,CAAb;AAEA,MAAMgB,OAAO,GAAGnH,QAAQ,CAACiF,aAAT,CAAuB,GAAvB,CAAhB;AACA,MAAM6B,OAAO,GAAGM,kBAAkB,CAACrN,IAAD,CAAlC;AAEAoN,EAAAA,OAAO,CAACE,YAAR,CAAqB,MAArB,EAA6B,kCAAkCP,OAA/D;AACAK,EAAAA,OAAO,CAACE,YAAR,CAAqB,UAArB,YAAoCH,QAApC;AACAC,EAAAA,OAAO,CAAChD,KAAR,CAAcmD,OAAd,GAAwB,MAAxB;AAEAtH,EAAAA,QAAQ,CAACuH,IAAT,CAAcC,WAAd,CAA0BL,OAA1B;AACAA,EAAAA,OAAO,CAAC7B,KAAR;AACAtF,EAAAA,QAAQ,CAACuH,IAAT,CAAcE,WAAd,CAA0BN,OAA1B;AACD;;AAED,SAAS1H,UAAT,GAA4C;AAAA,MAAxB+C,QAAwB,uEAAb,WAAa;AAC1CgC,EAAAA,OAAO,GAAGxE,QAAQ,CAACyC,aAAT,CAAuBD,QAAvB,CAAV;AACAgC,EAAAA,OAAO,CAACE,UAAR,GAAqBgB,iBAArB;AACAlB,EAAAA,OAAO,CAACH,OAAR,GAAkBoB,WAAlB;AACAjB,EAAAA,OAAO,CAACkD,SAAR,GAAoBlC,aAApB;AAEA,MAAMmC,OAAO,GAAG;AACdrF,IAAAA,QAAQ,EAARA,QADc;AAEdsF,IAAAA,MAAM,EAAEf,UAFM;AAGdgB,IAAAA,MAAM,EAAEb,UAHM;AAIdL,IAAAA,MAAM,EAANA,MAJc;AAKdnH,IAAAA,IAAI,EAAJA,IALc;AAMd+G,IAAAA,IAAI,EAAJA,IANc;AAOdlD,IAAAA,IAAI,EAAJA,IAPc;AAQduC,IAAAA,IAAI,EAAJA;AARc,GAAhB;AAWA7E,EAAAA,MAAM,CAACwD,EAAP,GAAY,EAAZ;AACAxD,EAAAA,MAAM,CAACwD,EAAP,CAAUC,OAAV,GAAoBmD,OAApB;AACA,SAAOA,OAAP;AACD;;eAEclI;;;;;;;;;;AC3Pf;;AACA;;AACA;;AACA;;AAEA;;;;AAEA;AACA,IAAIqI,QAAJ,EAAc;;AAEd,IAAMb,KAAK,GAAGjE,mBAAEhI,OAAF,GAAYK,IAAZ,EAAd;;AACA,IAAM0M,OAAO,GAAG,uBAAhB;AACA,IAAMvD,OAAO,GAAG,sBAAY,WAAZ,CAAhB;AACA,IAAMpG,MAAM,GAAG,qBAAW,YAAX,CAAf,EAEA;;AACAA,MAAM,CAACwD,QAAP,CAAgB4C,OAAO,CAACmC,MAAxB,GAEA;;AACAnC,OAAO,CAAClC,QAAR,CAAiB,OAAjB,EAA0B0F,YAA1B;AACAxD,OAAO,CAAClC,QAAR,CAAiB,UAAjB,EAA6B2F,eAA7B;AACAzD,OAAO,CAAChF,IAAR,IAEA;AACA;;AAEA3D,UAAU,CAAC,YAAM;AACfmE,EAAAA,QAAQ,CAACyC,aAAT,CAAuB,YAAvB,EAAqCzF,SAArC,CAA+C0D,MAA/C,CAAsD,QAAtD;AACAV,EAAAA,QAAQ,CAACyC,aAAT,CAAuB,UAAvB,EAAmCzF,SAAnC,CAA6CkH,GAA7C,CAAiD,QAAjD;AACD,CAHS,EAGP,GAHO,CAAV;;AAKA,SAAS8D,YAAT,CAAsBvJ,QAAtB,EAAgC3B,EAAhC,EAAoC;AAClCsB,EAAAA,MAAM,CAACoB,IAAP,CAAYf,QAAZ;AACA3B,EAAAA,EAAE,KAAKgL,QAAQ,GAAGhL,EAAhB,CAAF;AACD;;AAED,SAASmL,eAAT,CAAyBxJ,QAAzB,EAAmC3B,EAAnC,EAAuC;AACrCsB,EAAAA,MAAM,CAACoB,IAAP,CAAYf,QAAZ;AACAqJ,EAAAA,QAAQ,GAAGhL,EAAX;AACD","file":"src.a2b27638.map","sourceRoot":"..","sourcesContent":["var pSlice = Array.prototype.slice;\nvar Object_keys = typeof Object.keys === 'function'\n    ? Object.keys\n    : function (obj) {\n        var keys = [];\n        for (var key in obj) keys.push(key);\n        return keys;\n    }\n;\n\nvar deepEqual = module.exports = function (actual, expected) {\n  // enforce Object.is +0 !== -0\n  if (actual === 0 && expected === 0) {\n    return areZerosEqual(actual, expected);\n\n  // 7.1. All identical values are equivalent, as determined by ===.\n  } else if (actual === expected) {\n    return true;\n\n  } else if (actual instanceof Date && expected instanceof Date) {\n    return actual.getTime() === expected.getTime();\n\n  } else if (isNumberNaN(actual)) {\n    return isNumberNaN(expected);\n\n  // 7.3. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if (typeof actual != 'object' && typeof expected != 'object') {\n    return actual == expected;\n\n  // 7.4. For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else {\n    return objEquiv(actual, expected);\n  }\n};\n\nfunction isUndefinedOrNull(value) {\n  return value === null || value === undefined;\n}\n\nfunction isArguments(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n}\n\nfunction isNumberNaN(value) {\n  // NaN === NaN -> false\n  return typeof value == 'number' && value !== value;\n}\n\nfunction areZerosEqual(zeroA, zeroB) {\n  // (1 / +0|0) -> Infinity, but (1 / -0) -> -Infinity and (Infinity !== -Infinity)\n  return (1 / zeroA) === (1 / zeroB);\n}\n\nfunction objEquiv(a, b) {\n  if (isUndefinedOrNull(a) || isUndefinedOrNull(b))\n    return false;\n\n  // an identical 'prototype' property.\n  if (a.prototype !== b.prototype) return false;\n  //~~~I've managed to break Object.keys through screwy arguments passing.\n  //   Converting to array solves the problem.\n  if (isArguments(a)) {\n    if (!isArguments(b)) {\n      return false;\n    }\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return deepEqual(a, b);\n  }\n  try {\n    var ka = Object_keys(a),\n        kb = Object_keys(b),\n        key, i;\n  } catch (e) {//happens when one is a string literal and the other isn't\n    return false;\n  }\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length != kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] != kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!deepEqual(a[key], b[key])) return false;\n  }\n  return true;\n}\n","let serial = -1;\nconst uuid = () => {\n  serial++;\n  return (\n    String.fromCharCode(65 + (serial % 26)).toLowerCase() +\n    (\n      new Date().valueOf().toString(16) + // eg 127b795136 (11)\n      Math.floor(1000 + Math.random() * 1000).toString(13) + // eg aa7 (3)\n      (1000 + (serial % 1000)).toString(5) + // eg 13001 (5)\n      \"\"\n    ).slice(-15)\n  );\n};\n\nexport default uuid;\n","\r\nmodule.exports = function sanitizeHtml(text, opts) {\r\n  // Strip HTML from Text using browser HTML parser\r\n  if ((typeof text == 'string' || text instanceof String) && typeof document !== \"undefined\") {\r\n    var $div = document.createElement(\"DIV\");\r\n    $div.innerHTML = text;\r\n    text = ($div.textContent || '').trim();\r\n  }\r\n  //DOM Object\r\n  else if (typeof text === 'object' && text.textContent) {\r\n    text = (text.textContent || '').trim();\r\n  }\r\n\r\n  return text;\r\n};\r\n","\r\nexports.endsWithChar = function ends_with_char(word, c) {\r\n    if (c.length > 1) {\r\n        return c.indexOf(word.slice(-1)) > -1;\r\n    }\r\n\r\n    return word.slice(-1) === c;\r\n};\r\n\r\nexports.endsWith = function ends_with(word, end) {\r\n    return word.slice(word.length - end.length) === end;\r\n};","var abbreviations;\r\nvar englishAbbreviations = [\r\n    \"al\",\r\n    \"adj\",\r\n    \"assn\",\r\n    \"Ave\",\r\n    \"BSc\", \"MSc\",\r\n    \"Cell\",\r\n    \"Ch\",\r\n    \"Co\",\r\n    \"cc\",\r\n    \"Corp\",\r\n    \"Dem\",\r\n    \"Dept\",\r\n    \"ed\",\r\n    \"eg\",\r\n    \"Eq\",\r\n    \"Eqs\",\r\n    \"est\",\r\n    \"est\",\r\n    \"etc\",\r\n    \"Ex\",\r\n    \"ext\", // + number?\r\n    \"Fig\",\r\n    \"fig\",\r\n    \"Figs\",\r\n    \"figs\",\r\n    \"i.e\",\r\n    \"ie\",\r\n    \"Inc\",\r\n    \"inc\",\r\n    \"Jan\",\"Feb\",\"Mar\",\"Apr\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Sept\",\"Oct\",\"Nov\",\"Dec\",\r\n    \"jr\",\r\n    \"mi\",\r\n    \"Miss\", \"Mrs\", \"Mr\", \"Ms\",\r\n    \"Mol\",\r\n    \"mt\",\r\n    \"mts\",\r\n    \"no\",\r\n    \"Nos\",\r\n    \"PhD\", \"MD\", \"BA\", \"MA\", \"MM\",\r\n    \"pl\",\r\n    \"pop\",\r\n    \"pp\",\r\n    \"Prof\", \"Dr\",\r\n    \"pt\",\r\n    \"Ref\",\r\n    \"Refs\",\r\n    \"Rep\",\r\n    \"repr\",\r\n    \"rev\",\r\n    \"Sec\",\r\n    \"Secs\",\r\n    \"Sgt\", \"Col\", \"Gen\", \"Rep\", \"Sen\",'Gov', \"Lt\", \"Maj\", \"Capt\",\"St\",\r\n    \"Sr\", \"sr\", \"Jr\", \"jr\", \"Rev\",\r\n    \"Sun\",\"Mon\",\"Tu\",\"Tue\",\"Tues\",\"Wed\",\"Th\",\"Thu\",\"Thur\",\"Thurs\",\"Fri\",\"Sat\",\r\n    \"trans\",\r\n    \"Univ\",\r\n    \"Viz\",\r\n    \"Vol\",\r\n    \"vs\",\r\n    \"v\",\r\n];\r\n\r\nexports.setAbbreviations = function(abbr) {\r\n    if(abbr){\r\n        abbreviations = abbr;\r\n    } else {\r\n        abbreviations = englishAbbreviations;\r\n    }\r\n}\r\n\r\nvar isCapitalized = exports.isCapitalized = function(str) {\r\n    return /^[A-Z][a-z].*/.test(str) || isNumber(str);\r\n}\r\n\r\n// Start with opening quotes or capitalized letter\r\nexports.isSentenceStarter = function(str) {\r\n    return isCapitalized(str) || /``|\"|'/.test(str.substring(0,2));\r\n}\r\n\r\nexports.isCommonAbbreviation = function(str) {\r\n    return ~abbreviations.indexOf(str.replace(/\\W+/g, ''));\r\n}\r\n\r\n// This is going towards too much rule based\r\nexports.isTimeAbbreviation = function(word, next) {\r\n    if (word === \"a.m.\" || word === \"p.m.\") {\r\n        var tmp = next.replace(/\\W+/g, '').slice(-3).toLowerCase();\r\n\r\n        if (tmp === \"day\") {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nexports.isDottedAbbreviation = function(word) {\r\n    var matches = word.replace(/[\\(\\)\\[\\]\\{\\}]/g, '').match(/(.\\.)*/);\r\n    return matches && matches[0].length > 0;\r\n}\r\n\r\n// TODO look for next words, if multiple are capitalized,\r\n// then it's probably not a sentence ending\r\nexports.isCustomAbbreviation = function(str) {\r\n    if (str.length <= 3) {\r\n        return true;\r\n    }\r\n\r\n    return isCapitalized(str);\r\n}\r\n\r\n// Uses current word count in sentence and next few words to check if it is\r\n// more likely an abbreviation + name or new sentence.\r\nexports.isNameAbbreviation = function(wordCount, words) {\r\n    if (words.length > 0) {\r\n        if (wordCount < 5 && words[0].length < 6 && isCapitalized(words[0])) {\r\n            return true;\r\n        }\r\n\r\n        var capitalized = words.filter(function(str) {\r\n            return /[A-Z]/.test(str.charAt(0));\r\n        });\r\n\r\n        return capitalized.length >= 3;\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nvar isNumber = exports.isNumber = function(str, dotPos) {\r\n    if (dotPos) {\r\n        str = str.slice(dotPos-1, dotPos+2);\r\n    }\r\n\r\n    return !isNaN(str);\r\n};\r\n\r\n// Phone number matching\r\n// http://stackoverflow.com/a/123666/951517\r\nexports.isPhoneNr = function(str) {\r\n    return str.match(/^(?:(?:\\+?1\\s*(?:[.-]\\s*)?)?(?:\\(\\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\\s*\\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\\s*(?:[.-]\\s*)?)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\\s*(?:[.-]\\s*)?([0-9]{4})(?:\\s*(?:#|x\\.?|ext\\.?|extension)\\s*(\\d+))?$/);\r\n};\r\n\r\n// Match urls / emails\r\n// http://stackoverflow.com/a/3809435/951517\r\nexports.isURL = function(str) {\r\n    return str.match(/[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)/);\r\n};\r\n\r\n// Starting a new sentence if beginning with capital letter\r\n// Exception: The word is enclosed in brackets\r\nexports.isConcatenated = function(word) {\r\n    var i = 0;\r\n\r\n    if ((i = word.indexOf(\".\")) > -1 ||\r\n        (i = word.indexOf(\"!\")) > -1 ||\r\n        (i = word.indexOf(\"?\")) > -1)\r\n    {\r\n        var c = word.charAt(i + 1);\r\n\r\n        // Check if the next word starts with a letter\r\n        if (c.match(/[a-zA-Z].*/)) {\r\n            return [word.slice(0, i), word.slice(i+1)];\r\n        }\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\nexports.isBoundaryChar = function(word) {\r\n    return word === \".\" ||\r\n           word === \"!\" ||\r\n           word === \"?\";\r\n};\r\n","/*jshint node:true, laxcomma:true */\r\n\"use strict\";\r\n\r\nvar sanitizeHtml = require('sanitize-html');\r\n\r\nvar stringHelper = require('./stringHelper');\r\nvar Match  = require('./Match');\r\n\r\nvar newline_placeholder = \" @~@ \";\r\nvar newline_placeholder_t = newline_placeholder.trim();\r\n\r\n\r\nvar whiteSpaceCheck = new RegExp(\"\\\\S\", \"\");\r\nvar addNewLineBoundaries = new RegExp(\"\\\\n+|[-#=_+*]{4,}\", \"g\");\r\nvar splitIntoWords = new RegExp(\"\\\\S+|\\\\n\", \"g\");\r\n\r\n\r\n// Split the entry into sentences.\r\nexports.sentences = function(text, user_options) {\r\n    if (!text || typeof text !== \"string\" || !text.length) {\r\n        return [];\r\n    }\r\n\r\n    if (!whiteSpaceCheck.test(text)) {\r\n      // whitespace-only string has no sentences\r\n      return [];\r\n    }\r\n\r\n    var options = {\r\n        \"newline_boundaries\"  : false,\r\n        \"html_boundaries\"     : false,\r\n        \"html_boundaries_tags\": [\"p\",\"div\",\"ul\",\"ol\"],\r\n        \"sanitize\"            : false,\r\n        \"allowed_tags\"        : false,\r\n        \"preserve_whitespace\" : false,\r\n        \"abbreviations\"       : null\r\n    };\r\n\r\n    if (typeof user_options === \"boolean\") {\r\n        // Deprecated quick option\r\n        options.newline_boundaries = true;\r\n    }\r\n    else {\r\n        // Extend options\r\n        for (var k in user_options) {\r\n            options[k] = user_options[k];\r\n        }\r\n    }\r\n\r\n    Match.setAbbreviations(options.abbreviations);\r\n\r\n    if (options.newline_boundaries) {\r\n        text = text.replace(addNewLineBoundaries, newline_placeholder);\r\n    }\r\n\r\n    if (options.html_boundaries) {\r\n        var html_boundaries_regexp = \"(<br\\\\s*\\\\/?>|<\\\\/(\" + options.html_boundaries_tags.join(\"|\") + \")>)\";\r\n        var re = new RegExp(html_boundaries_regexp, \"g\");\r\n        text = text.replace(re, \"$1\" + newline_placeholder);\r\n    }\r\n\r\n    if (options.sanitize || options.allowed_tags) {\r\n        if (! options.allowed_tags) {\r\n            options.allowed_tags = [\"\"];\r\n        }\r\n\r\n        text = sanitizeHtml(text, { \"allowedTags\" : options.allowed_tags });\r\n    }\r\n\r\n\r\n    // Split the text into words\r\n    var words;\r\n    var tokens;\r\n\r\n    // Split the text into words\r\n    if (options.preserve_whitespace) {\r\n        // <br> tags are the odd man out, as whitespace is allowed inside the tag\r\n        tokens = text.split(/(<br\\s*\\/?>|\\S+|\\n+)/);\r\n\r\n        // every other token is a word\r\n        words = tokens.filter(function (token, ii) {\r\n          return ii % 2;\r\n        });\r\n    }\r\n    else {\r\n        // - see http://blog.tompawlak.org/split-string-into-tokens-javascript\r\n        words = text.trim().match(splitIntoWords);\r\n    }\r\n\r\n\r\n    var wordCount = 0;\r\n    var index = 0;\r\n    var temp  = [];\r\n    var sentences = [];\r\n    var current   = [];\r\n\r\n    // If given text is only whitespace (or nothing of \\S+)\r\n    if (!words || !words.length) {\r\n        return [];\r\n    }\r\n\r\n    for (var i=0, L=words.length; i < L; i++) {\r\n        wordCount++;\r\n\r\n        // Add the word to current sentence\r\n        current.push(words[i]);\r\n\r\n        // Sub-sentences, reset counter\r\n        if (~words[i].indexOf(',')) {\r\n            wordCount = 0;\r\n        }\r\n\r\n        if (Match.isBoundaryChar(words[i]) || stringHelper.endsWithChar(words[i], \"?!\") || words[i] === newline_placeholder_t) {\r\n            if ((options.newline_boundaries || options.html_boundaries) && words[i] === newline_placeholder_t) {\r\n                current.pop();\r\n            }\r\n\r\n            sentences.push(current);\r\n\r\n            wordCount = 0;\r\n            current   = [];\r\n\r\n            continue;\r\n        }\r\n\r\n\r\n        if (stringHelper.endsWithChar(words[i], \"\\\"\") || stringHelper.endsWithChar(words[i], \"”\")) {\r\n            words[i] = words[i].slice(0, -1);\r\n        }\r\n\r\n        // A dot might indicate the end sentences\r\n        // Exception: The next sentence starts with a word (non abbreviation)\r\n        //            that has a capital letter.\r\n        if (stringHelper.endsWithChar(words[i], '.')) {\r\n            // Check if there is a next word\r\n            // This probably needs to be improved with machine learning\r\n            if (i+1 < L) {\r\n                // Single character abbr.\r\n                if (words[i].length === 2 && isNaN(words[i].charAt(0))) {\r\n                    continue;\r\n                }\r\n\r\n                // Common abbr. that often do not end sentences\r\n                if (Match.isCommonAbbreviation(words[i])) {\r\n                    continue;\r\n                }\r\n\r\n                // Next word starts with capital word, but current sentence is\r\n                // quite short\r\n                if (Match.isSentenceStarter(words[i+1])) {\r\n                    if (Match.isTimeAbbreviation(words[i], words[i+1])) {\r\n                        continue;\r\n                    }\r\n\r\n                    // Dealing with names at the start of sentences\r\n                    if (Match.isNameAbbreviation(wordCount, words.slice(i, 6))) {\r\n                        continue;\r\n                    }\r\n\r\n                    if (Match.isNumber(words[i+1])) {\r\n                        if (Match.isCustomAbbreviation(words[i])) {\r\n                            continue;\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    // Skip ellipsis\r\n                    if (stringHelper.endsWith(words[i], \"..\")) {\r\n                        continue;\r\n                    }\r\n\r\n                    //// Skip abbreviations\r\n                    // Short words + dot or a dot after each letter\r\n                    if (Match.isDottedAbbreviation(words[i])) {\r\n                        continue;\r\n                    }\r\n\r\n                    if (Match.isNameAbbreviation(wordCount, words.slice(i, 5))) {\r\n                        continue;\r\n                    }\r\n                }\r\n            }\r\n\r\n            sentences.push(current);\r\n            current   = [];\r\n            wordCount = 0;\r\n\r\n            continue;\r\n        }\r\n\r\n        // Check if the word has a dot in it\r\n        if ((index = words[i].indexOf(\".\")) > -1) {\r\n            if (Match.isNumber(words[i], index)) {\r\n                continue;\r\n            }\r\n\r\n            // Custom dotted abbreviations (like K.L.M or I.C.T)\r\n            if (Match.isDottedAbbreviation(words[i])) {\r\n                continue;\r\n            }\r\n\r\n            // Skip urls / emails and the like\r\n            if (Match.isURL(words[i]) || Match.isPhoneNr(words[i])) {\r\n                continue;\r\n            }\r\n        }\r\n\r\n        if (temp = Match.isConcatenated(words[i])) {\r\n            current.pop();\r\n            current.push(temp[0]);\r\n            sentences.push(current);\r\n\r\n            current = [];\r\n            wordCount = 0;\r\n            current.push(temp[1]);\r\n        }\r\n    }\r\n\r\n    if (current.length) {\r\n        sentences.push(current);\r\n    }\r\n\r\n\r\n    // Clear \"empty\" sentences\r\n    sentences = sentences.filter(function(s) {\r\n        return s.length > 0;\r\n    });\r\n\r\n    var result = sentences.slice(1).reduce(function (out, sentence) {\r\n      var lastSentence = out[out.length - 1];\r\n      // Single words, could be \"enumeration lists\"\r\n      if (lastSentence.length === 1 && /^.{1,2}[.]$/.test(lastSentence[0])) {\r\n          // Check if there is a next sentence\r\n          // It should not be another list item\r\n          if (!/[.]/.test(sentence[0])) {\r\n              out.pop()\r\n              out.push(lastSentence.concat(sentence));\r\n              return out;\r\n          }\r\n      }\r\n      out.push(sentence);\r\n      return out;\r\n    }, [ sentences[0] ]);\r\n\r\n    // join tokens back together\r\n    return result.map(function (sentence, ii) {\r\n      if (options.preserve_whitespace && !options.newline_boundaries && !options.html_boundaries) {\r\n        // tokens looks like so: [leading-space token, non-space token, space\r\n        // token, non-space token, space token... ]. In other words, the first\r\n        // item is the leading space (or the empty string), and the rest of\r\n        // the tokens are [non-space, space] token pairs.\r\n        var tokenCount = sentence.length * 2;\r\n        if (ii === 0) {\r\n          tokenCount += 1;\r\n        }\r\n        return tokens.splice(0, tokenCount).join('');\r\n      }\r\n      return sentence.join(\" \");\r\n    });\r\n};\r\n","import SBD from \"sbd\";\n\nfunction inflate(text) {\n  // returns sentences broken into lines\n  const array = SBD.sentences(text);\n  return array.join(\"\\n\\n\");\n}\n\nexport default inflate;\n","const messages = {\r\n  confirmDelete: `\r\nYou are unlocking this paragraph. \r\n\r\nThis will delete the working versions and destill \r\nthe paragraph to the currently elected candidate.\r\n\r\n[CANCEL] to keep working versions\r\n[OK] to discard versions\r\n`\r\n};\r\n\r\nexport default function(key) {\r\n  return messages[key] || `WARNING:\\n\\nCan't find [${key}] message.`;\r\n}\r\n","function wordcount(value) {\r\n  return value\r\n    .replace(/[\\.\\n]+/g, \"\")\r\n    .replace(/(\\s\\s+)/g, \"\")\r\n    .split(\" \").length;\r\n}\r\n\r\nexport default wordcount;\r\n","import deepEqual from \"deep-is\";\nimport uuid from \"./uuid\";\nimport inflate from \"./inflate\";\nimport message from \"./message\";\nimport wordcount from \"./wordcount\";\n\nlet timer;\nlet count = 0;\nlet delay = 250;\n\nfunction time() {\n  return new Date().toString().replace(/.* (\\d+:\\d+:\\d+) .*/g, \"$1\");\n}\nfunction storage(sufix = null) {\n  const ns = [\"rewrite\", sufix].filter(val => val).join(\"-\");\n\n  return {\n    read: () => {\n      const data = localStorage[ns] || null;\n      return data && JSON.parse(data);\n    },\n\n    write: obj => {\n      clearTimeout(timer);\n      count = (count || 0) + 1;\n      timer = setTimeout(() => {\n        console.log(\"localstroage SAVE\", count, time(), obj);\n        localStorage[ns] = JSON.stringify(obj);\n        count = 0;\n      }, delay);\n    }\n  };\n}\n\nexport default {\n  uuid,\n  deepEqual,\n  inflate,\n  storage,\n  message,\n  wordcount,\n  time\n};\n","function empty(s) {\n  if (s === undefined) return;\n  return s;\n}\n\nexport default empty;\n","const settings = require(\"./config\");\n\nfunction htmlToStringArray(children, options = {}) {\n  const { prefixToken, className } = { ...settings, ...options };\n\n  return [...children].map(el => {\n    const { innerText, classList } = el;\n    const is_comment = classList.contains(className);\n    const prefix = is_comment ? prefixToken : \"\";\n\n    return `${prefix}${innerText.trim()}`;\n  });\n}\n\nexport default htmlToStringArray;\n","function textToArray(text = null) {\n  // returns simple text Array\n  // correcting for double line breaks\n  if (!text) return;\n\n  return text.split(/\\n/g);\n  // return text.replace(/\\n\\n/g, \"\\n\").split(/\\n/g);\n}\n\nexport default textToArray;\n","const re_punctuation = /(\\.|\\:|\\!|\\?|\\\"|\\))$/g;\n\nfunction terminate(text, autoTerminate = false) {\n  // return a closed sentnece.\n  text = text && text.trim();\n\n  if (!text) return;\n\n  var is_closed = re_punctuation.test(text);\n  var sufix = autoTerminate && !is_closed ? \".\" : \"\";\n\n  return `${text}${sufix}`;\n}\n\nexport default terminate;\n","import terminate from \"./terminate\";\nimport textToArray from \"./textToArray\";\n\nconst re_comments = /^([\\/\\>\\?\\=\\!]\\s*?)/;\n\nfunction getCandidateString(value, autoTerminate = false) {\n  // recieve String or Array\n  // returns string\n  // parse the DOM elements to simple Array\n\n  const is_array = value && value.constructor === Array;\n  const array = is_array ? value : textToArray(value);\n  return [...array]\n    .map(line =>\n      re_comments.test(line) ? null : terminate(line, autoTerminate)\n    )\n    .filter(s => s && s.length)\n    .join(\" \")\n    .trim();\n}\n\nexport default getCandidateString;\n","const comment = new RegExp(\"^[>]s?\", \"g\");\n\nfunction arrayToHtml(array) {\n  // returns DOM string\n  // parse comment chars to className \"comment\"\n\n  return [...array]\n    .map(text => {\n      const className = comment.test(text) ? ` class=\"comment\"` : \"\";\n      const value = text ? text.replace(comment, \"\").trim() : \"<br />\";\n\n      return `<div${className}>${value}</div>`;\n    })\n    .join(\"\\n\")\n    .toString();\n}\n\nexport default arrayToHtml;\n","import defaultConfig from \"./config\";\nimport empty from \"./empty\";\nimport htmlToStringArray from \"./htmlToStringArray\";\nimport textToArray from \"./textToArray\";\nimport getCandidateString from \"./getCandidateString\";\nimport arrayToHtml from \"./arrayToHtml\";\nimport wordcount from \"../utilities/wordcount\";\n\nimport \"./editor.scss\";\n\n/*\n\n  const e = initialize($elm, {...options})\n\n  e.onChange((candidate, versions) = console.log(candidate, versions))\n  \n  e.trigger(\"shiftaltalt\", toggleCase);\n\n  const toggleCase = el => {\n    const text = el.innerText;\n    const upper = text.toUpperCase() === text;\n    const toggle = upper ? \"toLowerCase\" : \"toUpperCase\";\n    el.innerText = text[toggle]();\n  };\n\n*/\n\nlet editor;\nlet config = { ...defaultConfig };\n\nlet cache = {\n  candidate: null, // string\n  versions: [null] // versions\n};\n\n// const re_comment_prefix = new RegExp(\"^[>]s?\", \"g\");\nconst re_punctuation = /(\\.|\\:|\\!|\\?|\\\"|\\))$/g;\nconst re_comments = /^([\\/\\>\\?\\=\\!]\\s*?)/;\nconsole.log(re_punctuation);\n\nconst triggerDictionary = {\n  cleanup: cleanupBlanks,\n  shiftshift: toggleComment,\n  controlt: toggleComment\n};\n\n// [\"Lorem ipsum 1\",\"Lorem ipsum 2\",\"> Lorem ipsum 4\",\"\",\"Lorem ipsum 3\"]\nfunction clearVersions() {\n  editor.innerHTML = \"\";\n  editor = null;\n  cache.candidate = null;\n  cache.versions = [null];\n  // issue onClose event\n}\n\nfunction setWordcount(row) {\n  if (!row || !row.innerText) return;\n  const words = wordcount(row.innerText);\n  row.dataset.wordcount = words;\n}\n\nfunction updateWordCountDataset() {\n  if (config.showWordCount) {\n    [...editor.children].map(setWordcount);\n  }\n}\n\nfunction load(value = null, options = {}) {\n  if (!value) return;\n  if (!editor) initialize();\n\n  const array = value.constructor === Array ? value : textToArray(value);\n  const html = arrayToHtml(array);\n\n  config = Object.assign({}, config, options);\n\n  editor.innerHTML = html;\n  editor.focus();\n\n  updateWordCountDataset();\n  notifyChanges();\n  return html;\n}\n\nfunction toggleComment(bool) {\n  var line = document.getSelection().focusNode.parentNode;\n  var text = line.innerText;\n  var skip = !/div/i.test(line.nodeName) || !text || !text.trim();\n\n  if (skip) return;\n\n  line.classList.toggle(\"comment\");\n}\n\nfunction cleanupBlanks(rows) {\n  [...rows].forEach((row, n) => {\n    const text = (row.innerText && row.innerText.trim()) || null;\n    text ? row : row.classList.remove(\"comment\");\n  });\n}\n\nfunction executeTriggers(e, keyTime, keyHistory) {\n  const { parentNode } = window.getSelection().focusNode;\n  const children = parentNode.children;\n\n  keyHistory = keyHistory.join(\"\").toLowerCase();\n\n  const { cleanup, wordCount } = triggerDictionary;\n  const trigger =\n    triggerDictionary[keyHistory] ||\n    triggerDictionary[`id${keyHistory}`] ||\n    empty;\n\n  cleanup(children);\n  trigger(parentNode);\n  setWordcount(parentNode);\n  notifyChanges();\n}\n\nfunction bindEvents() {\n  let ts = 0;\n  let hist = [];\n\n  editor.onkeyup = e => {\n    const { doubleTap, resetDelay } = config;\n    const diff = e.timeStamp - ts;\n    const delay = diff < doubleTap;\n    ts = e.timeStamp;\n\n    hist = diff > resetDelay ? [] : hist;\n\n    hist.push(e.key);\n    hist = hist.slice(-5);\n\n    setTimeout(() => executeTriggers(e, delay, hist), 0);\n  };\n}\n\nfunction getVersionArray() {\n  const options = { ...config };\n  return htmlToStringArray(editor.children, options);\n}\n\nfunction notifyChanges() {\n  // if the candidate is diffrent OR\n  // if the version array is different\n  // execute the change\n  const { children } = editor;\n  const { candidate, versions } = { ...cache };\n  const { onChange } = config;\n  const string = htmlToStringArray(children);\n\n  const nextCandidate = String(getCandidateString(string));\n  const nextVersions = [...getVersionArray()];\n\n  // cheap checks first ...\n  const a = candidate !== nextCandidate;\n  const b = a || versions.length !== nextVersions.length;\n\n  // most expensive check\n  const execute =\n    b || versions.sort().join(\"\") !== nextVersions.sort().join(\"\");\n\n  // change detected\n  if (execute) {\n    cache = {\n      candidate: nextCandidate,\n      versions: nextVersions\n    };\n    onChange(nextCandidate, nextVersions);\n  }\n}\n\nfunction addOnChange(fn) {\n  config = Object.assign({}, config, { onChange: fn });\n}\n\nfunction trigger(key, callback) {\n  const id = triggerDictionary[key] ? `id${key}` : key;\n  triggerDictionary[id] = callback;\n  console.log(\"added trigger [%s]\", id, key);\n}\n\nfunction initialize(selector = null, options) {\n  config.selector = config.selector || selector;\n  editor = document.querySelector(config.selector);\n\n  if (!editor) {\n    throw `module requires DOM element [${selector}]`;\n  }\n\n  if (options) {\n    config = Object.assign({}, config, options);\n  }\n\n  bindEvents();\n  return {\n    load,\n    trigger,\n    clear: clearVersions,\n    settings: () => config,\n    onChange: addOnChange,\n    candidate: getCandidateString,\n    versions: htmlToStringArray\n  };\n}\n\nexport default initialize;\n","import u from \"../utilities\";\r\n\r\nlet A;\r\nlet B;\r\nlet left;\r\nlet vertical;\r\nlet dragging = false;\r\nconst { read, write } = u.storage(\"resizer\");\r\n\r\nlet state = Object.assign(\r\n  {},\r\n  {\r\n    width: 50, // initial ratio (percentage)\r\n    minWidth: 8, // min pixel width\r\n    threshold: 20, // screen width percentage\r\n\r\n    // DOM fixtures\r\n    vertical: \"#vertical\",\r\n    document: \".document\",\r\n    sentences: \".sentences\"\r\n  },\r\n  read()\r\n);\r\n\r\nfunction save(obj = {}) {\r\n  const data = { ...state, ...obj };\r\n  write(data);\r\n  return obj;\r\n}\r\n\r\nfunction settings(key, value) {\r\n  if (!key) return;\r\n\r\n  // key, value pairs\r\n  const temp = {};\r\n  if (key.constructor !== Object && value !== undefined) {\r\n    temp[key] = value;\r\n    key = { ...temp };\r\n  }\r\n\r\n  state = { ...state, key };\r\n  return save(state);\r\n}\r\n\r\nfunction resize(e, value) {\r\n  if (!dragging && !value) return;\r\n\r\n  let { pageX } = e || {};\r\n\r\n  if (e) {\r\n    // prevent cursor selecting during drag\r\n    e.stopPropagation && e.stopPropagation();\r\n    e.preventDefault && e.preventDefault();\r\n    e.cancelBubble = true;\r\n    e.returnValue = false;\r\n  }\r\n\r\n  const { threshold, minWidth } = state;\r\n  const { innerWidth } = window;\r\n\r\n  pageX = pageX || ((value || 50) / 100) * innerWidth;\r\n  let width = value || Number((pageX / innerWidth) * 100);\r\n  width = Math.max(minWidth, width);\r\n  width = Math.min(100 - minWidth, width);\r\n\r\n  let percent = width;\r\n  A.classList.remove(\"hide-content\");\r\n  B.classList.remove(\"hide-content\");\r\n  vertical.classList.remove(\"hide-menu-left\");\r\n  vertical.classList.remove(\"hide-menu-right\");\r\n\r\n  if (width < threshold) {\r\n    // 15 (100-85) (innerWidth - minWidth) / innerWidth\r\n    percent = 100 * (minWidth / innerWidth);\r\n    A.classList.add(\"hide-content\");\r\n    vertical.classList.add(\"hide-menu-left\");\r\n  }\r\n  if (width > 100 - threshold) {\r\n    percent = 100 - 100 * ((minWidth * 1.5) / innerWidth);\r\n    B.classList.add(\"hide-content\");\r\n    vertical.classList.add(\"hide-menu-right\");\r\n  }\r\n\r\n  A.style.width = `${percent}%`;\r\n  B.style.width = `${100 - percent}%`;\r\n  vertical.style.left = `${percent}%`;\r\n\r\n  save({ width: Number(percent) });\r\n}\r\n\r\nfunction bindMenuEvents() {\r\n  left.onclick = e => {\r\n    const { nodeName, dataset } = e.target;\r\n    if (nodeName !== \"LI\") return;\r\n    console.log(nodeName, dataset.fn);\r\n    const fn = dataset.fn;\r\n    window.RE.article[fn]();\r\n  };\r\n}\r\n\r\nfunction initialize(options = {}) {\r\n  vertical = document.querySelector(state.vertical);\r\n  left = document.querySelector(\"#left-menu\");\r\n  A = document.querySelector(state.document);\r\n  B = document.querySelector(state.sentences);\r\n\r\n  bindMenuEvents();\r\n\r\n  vertical.onmousedown = () => (dragging = true);\r\n  vertical.ondblclick = e => resize(e, 50);\r\n\r\n  window.onmouseup = () => {\r\n    dragging = false;\r\n    console.log(\"WINDOW [%s]\", state.width);\r\n  };\r\n\r\n  window.onmousemove = resize;\r\n\r\n  save(options);\r\n  resize(null, state.width);\r\n\r\n  console.log(\"resizer initialized\");\r\n\r\n  return { resize, settings };\r\n}\r\n\r\nexport default initialize;\r\n","import uuid from \"../utilities/uuid\";\nimport getCandidateString from \"./getCandidateString\";\n\nfunction collectionToHtml(array) {\n  // returns HTML String\n  // Expected collection schema:\n  // [{text: String, versions: Object}, ...]\n\n  if (!array) return;\n\n  const html = array.map(row => {\n    const { text = \"\", versions = \"\" } = row;\n\n    const id = versions ? uuid() : \"\";\n    const classname = (versions && \"locked\") || \"\";\n    const value = text || (versions && getCandidateString(versions)) || \"\";\n    const json = versions ? JSON.stringify(versions) : \"\";\n\n    // create DOM element to ensure json is parsed correctly\n    // when we use it as data-version String\n    const div = document.createElement(\"div\");\n\n    // only render relavant attributes\n    id && (div.id = id);\n    classname && (div.className = classname);\n    versions && (div.dataset.versions = json);\n\n    div.innerHTML = value || \"<br/>\";\n\n    return div.outerHTML;\n  });\n\n  return html.join(\"\\n\");\n}\n\nexport default collectionToHtml;\n","import u from \"../utilities\";\nimport collectionToHtml from \"../editor/collectionToHtml\";\nimport textToArray from \"../editor/textToArray\";\n\nlet article;\nlet selected;\nlet timer;\nlet delay = 1000;\n\nconst sample = require(\"./startup.json\");\nconst { read, write } = u.storage(\"article\");\n\nconst callbacks = {\n  click: () => {},\n  dblclick: () => {}\n};\n\nfunction callback(key, fn) {\n  callbacks[key.toLowerCase()] = fn;\n}\n\nfunction handleKeyDown(e) {\n  //! prevent locked rows from editing text\n  save();\n}\n\nfunction handleClick(e) {\n  // de-select any existing nodes\n  if (selected) {\n    selected.classList.remove(\"selected\");\n  }\n\n  // only load locked nodes\n  let { id, dataset } = e.target;\n  if (!id || !dataset.versions) return;\n\n  selected = document.querySelector(`#${id}`);\n  selected.classList.add(\"selected\");\n  selected.dataset.wordcount = u.wordcount(e.target.innerText);\n\n  const { versions } = dataset;\n  const json = versions && JSON.parse(versions);\n\n  callbacks.click(json, selected);\n}\n\nfunction handleDoubleClick(e) {\n  e.target.id = e.target.id || u.uuid();\n  let { id, innerText, dataset } = e.target;\n  const { versions } = dataset;\n  const text = u.inflate(innerText);\n  const value = (versions && JSON.parse(versions)) || text || \"\";\n\n  if (versions) {\n    // confirm delete\n    if (!window.confirm(u.message(\"confirmDelete\"))) return;\n\n    // next ... remove DOM reference\n    selected.id = \"\";\n    selected = null;\n\n    // next cleanup this\n    e.target.className = \"\";\n    e.target.id = \"\";\n    e.target.dataset.versions = \"\";\n\n    // update local storage\n    console.log(\"toggle off\", selected);\n    callbacks.dblclick(value, null);\n    return;\n  }\n\n  selected = document.querySelector(`#${id}`);\n  selected.className = \"locked selected\";\n  callbacks.dblclick(value, selected);\n}\n\nfunction list() {\n  const data = read();\n  const { articles } = data;\n  const keys = Object.keys(articles);\n  const list = keys.map((s, n) => `${n}: ${s}  ${articles[s].name}`).join(\"\\n\");\n  console.log(list);\n  return keys;\n}\n\nfunction htmlToCollection(children) {\n  return [...children].map(el => {\n    const { innerText = \"\", dataset } = el;\n    const versions = dataset.versions && JSON.parse(dataset.versions);\n\n    return {\n      text: innerText.trim(),\n      versions: versions\n    };\n  });\n}\n\nfunction save() {\n  timer && clearTimeout(timer);\n  timer = setTimeout(() => {\n    const collection = htmlToCollection(article.children);\n    const data = read();\n    const now = new Date().valueOf();\n    const { current } = data;\n    Object.assign(data.articles[current], { data: collection, opened: now });\n    write(data);\n  }, delay);\n}\n\nfunction create(key, data, name) {\n  const id = key || u.uuid();\n  const created = new Date().valueOf();\n  return { id, name, data, created };\n}\n\nfunction open() {\n  const keys = list();\n  const index = window.prompt(\"choose one:\");\n  load(keys[Number(index)]);\n}\n\nfunction load(key, name, collection) {\n  let id;\n  let data = read();\n  let current = null;\n  const ts = new Date().valueOf();\n\n  if (!data) {\n    const newobject = create(null, sample, \"Untitled\");\n    id = newobject.id;\n    data = { articles: {} };\n    data.articles[id] = { ...newobject };\n  }\n\n  // try to get the @key article\n  if (key && data.articles[key]) id = key;\n\n  // create a blank/new document\n  if (!id && (key || name || collection)) {\n    id = key || u.uuid();\n    name = name || \"New document\";\n    collection = collection || [{ text: name }];\n    data.articles[id] = create(id, collection, name);\n    console.log(\"NEW\", data.articles);\n  }\n\n  // try to use last document edited\n  if (!id && data.current && data.articles[data.current]) id = data.current;\n\n  // last resort open first article\n  if (!id) id = Object.keys(data.articles)[0];\n\n  current = data.articles[id];\n  current.opened = ts;\n  data.current = id;\n\n  //   const objectArray;\n  //   const innerHTML = collectionToHtml(local);\n  article.innerHTML = collectionToHtml(current.data);\n  write({ ...data });\n}\n\nfunction update(candidate, versions) {\n  // updates the currently selected node\n  if (!selected) {\n    console.error(\"cant update selected node\");\n    return;\n  }\n\n  selected.innerText = candidate;\n  selected.dataset.wordcount = u.wordcount(candidate);\n  selected.dataset.versions = JSON.stringify(versions);\n\n  save();\n}\n\nfunction importJSON(payload) {\n  let object;\n  let collection;\n  let text = payload || window.prompt(\"Please paste JSON export\");\n\n  try {\n    object = JSON.parse(text);\n  } catch (e) {\n    console.error(\"JSON import error\", e);\n  }\n\n  // payload is plainText\n  if (!object) {\n    collection = textToArray(text);\n    collection.map(row => {\n      text: row.trim();\n    });\n\n    object = {\n      id: u.uuid(),\n      name: \"Untitled Import\",\n      data: [...collection]\n    };\n  }\n\n  //! need to check the UUID does not exist OR\n  //! warn that it will replace the existring data\n\n  const { key, name, data } = object;\n\n  load(key, name, data);\n}\n\nfunction exportJSON() {\n  const local = read();\n  const { current } = local;\n  const { id, name } = local.articles[current];\n  const filename = `${name}-${id}`;\n  const text = JSON.stringify(local.articles[current]);\n\n  const element = document.createElement(\"a\");\n  const payload = encodeURIComponent(text);\n\n  element.setAttribute(\"href\", \"data:text/json;charset=utf-8,\" + payload);\n  element.setAttribute(\"download\", `${filename}.json`);\n  element.style.display = \"none\";\n\n  document.body.appendChild(element);\n  element.click();\n  document.body.removeChild(element);\n}\n\nfunction initialize(selector = \"#document\") {\n  article = document.querySelector(selector);\n  article.ondblclick = handleDoubleClick;\n  article.onclick = handleClick;\n  article.onkeydown = handleKeyDown;\n\n  const methods = {\n    callback,\n    import: importJSON,\n    export: exportJSON,\n    update,\n    load,\n    open,\n    save,\n    list\n  };\n\n  window.RE = {};\n  window.RE.article = methods;\n  return methods;\n}\n\nexport default initialize;\n","import u from \"./utilities\";\nimport editorInit from \"./editor\";\nimport divideInit from \"./divider\";\nimport articleInit from \"./article\";\n\nimport \"./styles.scss\";\n\n// load some text into the DOM\nlet $focusOn; // current node element\n\nconst local = u.storage().read();\nconst divider = divideInit();\nconst article = articleInit(\"#document\");\nconst editor = editorInit(\"#sentences\");\n\n// Passive events from Editor changes\neditor.onChange(article.update);\n\n// Initial DOM injection\narticle.callback(\"click\", reloadEditor);\narticle.callback(\"dblclick\", toggleParagraph);\narticle.load();\n\n// article.load(\"55555\", \"Kilroy!\", [{ text: \"Kilroy was here\" }]);\n// article.open();\n\nsetTimeout(() => {\n  document.querySelector(\".container\").classList.remove(\"hidden\");\n  document.querySelector(\".overlay\").classList.add(\"hidden\");\n}, 550);\n\nfunction reloadEditor(versions, el) {\n  editor.load(versions);\n  el && ($focusOn = el);\n}\n\nfunction toggleParagraph(versions, el) {\n  editor.load(versions);\n  $focusOn = el;\n}\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var bundle = require('./bundle-url');\n\nfunction updateLink(link) {\n  var newLink = link.cloneNode();\n  newLink.onload = function () {\n    link.remove();\n  };\n  newLink.href = link.href.split('?')[0] + '?' + Date.now();\n  link.parentNode.insertBefore(newLink, link.nextSibling);\n}\n\nvar cssTimeout = null;\nfunction reloadCSS() {\n  if (cssTimeout) {\n    return;\n  }\n\n  cssTimeout = setTimeout(function () {\n    var links = document.querySelectorAll('link[rel=\"stylesheet\"]');\n    for (var i = 0; i < links.length; i++) {\n      if (bundle.getBaseURL(links[i].href) === bundle.getBundleURL()) {\n        updateLink(links[i]);\n      }\n    }\n\n    cssTimeout = null;\n  }, 50);\n}\n\nmodule.exports = reloadCSS;\n"]}